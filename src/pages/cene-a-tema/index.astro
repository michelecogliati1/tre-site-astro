---
import Layout from "../../layouts/Layout.astro";

// SEO Data
const seoData = {
  title: "Cene a Tema - Eccellenze del Territorio - TRE Grill + Pizzeria",
  description: "Partecipa alle nostre Cene a Tema tra sapori stagionali ed eccellenze del territorio. Ricevi l'anteprima delle serate a tema e prenota un tavolo.",
  canonical: "https://www.ristorantepizzeriatre.it/cene-a-tema/",
  ogImage: "https://www.ristorantepizzeriatre.it/img/cene-tema/cena-tema-ristorante-pizzeria-tre-merate-hero.webp",
  preloadImage: "/img/cene-tema/cena-tema-ristorante-pizzeria-tre-merate-hero.webp",
};

// Dati Prossima Cena a Tema
const prossimaCena = {
  titolo: "Oktoberfest",
  data: "Venerdì 18 Ottobre 2024",
  ora: "ore 20.00",
  prezzo: "50,00",
  portate: [
    {
      tipo: "Aperitivo",
      piatto: "Obatzda (crema di formaggi bavaresi) con crostini di segale",
      abbinamento: "Tegernseer Hell – Herzoglich Bayerisches Brauhaus Tegernsee"
    },
    {
      tipo: "Antipasto",
      piatto: "Brezel caldo con burro aromatizzato e senape dolce",
      abbinamento: "Weihenstephaner Hefeweissbier – Weihenstephan"
    },
    {
      tipo: "Primo",
      piatto: "Zuppa di patate e porri con pancetta croccante",
      abbinamento: "Kellerbier – Ayinger"
    },
    {
      tipo: "Secondo",
      piatto: "Stinco di maiale al forno con crauti e patate",
      abbinamento: "Celebrator Doppelbock – Ayinger"
    },
    {
      tipo: "Dessert",
      piatto: "Strudel di mele con crema alla vaniglia",
      abbinamento: "Eisbock – Schneider Weisse"
    },
    {
      tipo: "Caffè",
      piatto: "",
      abbinamento: ""
    }
  ]
};

// Dati Cene Passate
const cenePasate = [
  {
    titolo: "Oktoberfest",
    data: "18 Ottobre 2024",
    immagine: "/img/cene-tema/cena-tema-oktober-fest-ristorante-pizzeria-tre-merate-carosello.webp"
  },
  {
    titolo: "ArTRE - arte in pizzeria",
    data: "16 Marzo 2023",
    immagine: "/img/cene-tema/cena-a-tema-artre-arte-in-pizzeria-tre-merate.webp"
  },
  {
    titolo: "Birra Vetra e Sapori Rustici",
    data: "13 Settembre 2022",
    immagine: "/img/cene-tema/cena-a-tema-birra-vetra-sapori-rustici-ristorante-pizzeria-tre-merate.webp"
  },
  {
    titolo: "Uniti per il Nepal - cena solidale",
    data: "16 Giugno 2015",
    immagine: "/img/cene-tema/cena-a-tema-solidale-uniti-per-il-nepal-ristorante-pizzeria-tre-merate.webp"
  }
];

// Dati Partner
const partners = [
  {
    nome: "Birra Vetra",
    logo: "/img/cene-tema/logo-birra-vetra-ristorante-pizzeria-tre-merate.svg"
  },
  {
    nome: "Birrificio Otus",
    logo: "/img/cene-tema/logo-birrificio-otus-ristorante-pizzeria-tre-merate.svg"
  },
  {
    nome: "Birrificio Rurale",
    logo: "/img/cene-tema/logo-birrificio-rurale-ristorante-pizzeria-tre-merate.svg"
  },
  {
    nome: "Cantina Villa Erica",
    logo: "/img/cene-tema/logo-cantina-vinicola-villa-erica-ristorante-pizzeria-tre-merate.svg"
  },
  {
    nome: "Deltetto",
    logo: "/img/cene-tema/logo-cantina-vinicola-deldetto-ristorante-pizzeria-tre-merate.svg"
  },
  {
    nome: "Moser Trento",
    logo: "/img/cene-tema/logo-cantina-vinicola-moser-ristorante-pizzeria-tre-merate.svg"
  }
];

// Schema.org per Event + BreadcrumbList
const schemaOrg = {
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "Event",
      "@id": "https://www.ristorantepizzeriatre.it/cene-a-tema/#event-oktoberfest",
      "name": "Cena a Tema Oktoberfest",
      "description": "Serata a tema bavarese con menù degustazione e birre artigianali selezionate. Aperitivo, antipasto, primo, secondo, dessert e caffè inclusi.",
      "startDate": "2024-10-18T20:00:00+02:00",
      "endDate": "2024-10-18T23:30:00+02:00",
      "eventStatus": "https://schema.org/EventScheduled",
      "eventAttendanceMode": "https://schema.org/OfflineEventAttendanceMode",
      "location": {
        "@type": "Restaurant",
        "name": "Ristorante Pizzeria TRE",
        "address": {
          "@type": "PostalAddress",
          "streetAddress": "Via Statale, 44",
          "addressLocality": "Merate",
          "addressRegion": "LC",
          "postalCode": "23807",
          "addressCountry": "IT"
        }
      },
      "image": "https://www.ristorantepizzeriatre.it/img/cene-tema/cena-tema-oktoberfest-ristorante-pizzeria-tre-merate-hero.webp",
      "offers": {
        "@type": "Offer",
        "price": "50.00",
        "priceCurrency": "EUR",
        "availability": "https://schema.org/InStock",
        "validFrom": "2024-09-01"
      },
      "organizer": {
        "@type": "Restaurant",
        "name": "Ristorante Pizzeria TRE",
        "url": "https://www.ristorantepizzeriatre.it/",
        "address": {
          "@type": "PostalAddress",
          "streetAddress": "Via Statale, 44", 
          "addressLocality": "Merate",
          "addressRegion": "LC",
          "postalCode": "23807",
          "addressCountry": "IT"
        }
      }
    },
    {
      "@type": "ItemList",
      "@id": "https://www.ristorantepizzeriatre.it/cene-a-tema/#past-events",
      "name": "Cene a Tema Passate",
      "description": "Archivio delle cene a tema organizzate dal Ristorante Pizzeria TRE",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Oktoberfest",
          "description": "Serata a tema bavarese - 18 Ottobre 2024"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "ArTRE - arte in pizzeria",
          "description": "Arte e gastronomia - 16 Marzo 2023"
        },
        {
          "@type": "ListItem",
          "position": 3,
          "name": "Birra Vetra e Sapori Rustici",
          "description": "Degustazione birre artigianali - 13 Settembre 2022"
        },
        {
          "@type": "ListItem",
          "position": 4,
          "name": "Uniti per il Nepal - cena solidale",
          "description": "Cena benefica - 16 Giugno 2015"
        }
      ]
    },
    {
      "@type": "BreadcrumbList",
      "@id": "https://www.ristorantepizzeriatre.it/cene-a-tema/#breadcrumb",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": "https://www.ristorantepizzeriatre.it/"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Cene a Tema",
          "item": "https://www.ristorantepizzeriatre.it/cene-a-tema/"
        }
      ]
    },
    {
      "@type": "WebPage",
      "@id": "https://www.ristorantepizzeriatre.it/cene-a-tema/#webpage",
      "url": "https://www.ristorantepizzeriatre.it/cene-a-tema/",
      "name": "Cene a Tema - Eccellenze del Territorio | Ristorante Pizzeria TRE Merate",
      "isPartOf": {
        "@id": "https://www.ristorantepizzeriatre.it/#website"
      },
      "primaryImageOfPage": {
        "@type": "ImageObject",
        "url": "https://www.ristorantepizzeriatre.it/img/cene-tema/cena-tema-ristorante-pizzeria-tre-merate-hero.webp"
      },
      "breadcrumb": {
        "@id": "https://www.ristorantepizzeriatre.it/cene-a-tema/#breadcrumb"
      },
      "inLanguage": "it-IT"
    }
  ]
};
---

<Layout 
  title={seoData.title}
  description={seoData.description}
  canonical={seoData.canonical}
  ogImage={seoData.ogImage}
  preloadImage={seoData.preloadImage}
>
  <!-- Schema.org JSON-LD -->
  <Fragment slot="schema">
    <script type="application/ld+json" set:html={JSON.stringify(schemaOrg)} />
  </Fragment>

  <!-- Hero Section -->
  <section class="hero hero-cene-tema">
    <div class="container hero-content">
      <h1>Cene a Tema con Menù a prezzo fisso</h1>
      <p>
        Unisciti a noi per serate speciali che combinano<br />
        cucina creativa e bevande selezionate abbinate
      </p>
      <div class="hero-buttons">
        <a href="#newsletter-cene" class="btn btn-primary">Ricevi Anteprima</a>
        <a href="/contatti/" class="btn btn-outline">Prenota Ora</a>
      </div>
    </div>
  </section>

  <!-- Breadcrumb -->
  <nav class="breadcrumb-nav" aria-label="Breadcrumb">
    <div class="container">
      <ol class="breadcrumb">
        <li><a href="/">Home</a></li>
        <li aria-current="page">Cene a Tema</li>
      </ol>
    </div>
  </nav>

  <!-- Prossima Cena a Tema -->
  <section class="prossima-cena-section" id="prossima-cena">
    <div class="container">
      <div class="prossima-cena-header">
        <span class="prossima-cena-label">Prossima Cena a Tema</span>
        <p class="prossima-cena-data">{prossimaCena.data}, {prossimaCena.ora}</p>
      </div>

      <div class="menu-degustazione">
        <h2 class="menu-degustazione-titolo">" {prossimaCena.titolo} "</h2>

        <div class="portate-list">
          {prossimaCena.portate.map((portata) => (
            <div class="portata-item">
              <h3 class="portata-tipo">{portata.tipo}</h3>
              {portata.piatto && (
                <>
                  <p class="portata-piatto">{portata.piatto}</p>
                  {portata.abbinamento && (
                    <p class="portata-abbinamento">{portata.abbinamento}</p>
                  )}
                </>
              )}
              <div class="portata-divider">
                <span class="dot"></span>
                <span class="dot"></span>
                <span class="dot"></span>
              </div>
            </div>
          ))}
        </div>

        <div class="menu-prezzo">
          <span class="prezzo-label">€ {prossimaCena.prezzo}</span>
          <span class="prezzo-suffix">a persona</span>
        </div>
      </div>
    </div>
  </section>

  <div class="section-divider"></div>

  <!-- Le Nostre Cene a Tema Passate -->
  <section class="cene-passate-section">
    <div class="container">
      <div class="section-header">
        <h2>Le Nostre Cene a Tema passate</h2>
        <p>
          Dai uno sguardo alle serate passate, con piatti unici e bevande abbinate per ogni tema
        </p>
      </div>

      <div class="carousel-wrapper">
        <button class="carousel-arrow carousel-arrow-left" data-carousel="cene-passate" aria-label="Precedente">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>

        <div class="carousel-container" data-carousel="cene-passate">
          <div class="carousel-track">
            {cenePasate.map((cena) => (
              <div class="cena-passata-card">
                <img
                  src={cena.immagine}
                  alt={`Cena a tema ${cena.titolo} - Ristorante TRE Merate`}
                  loading="lazy"
                  decoding="async"
                  width="400"
                  height="500"
                />
                <div class="cena-passata-overlay">
                  <h3 class="cena-passata-titolo">{cena.titolo}</h3>
                  <p class="cena-passata-data">{cena.data}</p>
                </div>
              </div>
            ))}
          </div>
        </div>

        <button class="carousel-arrow carousel-arrow-right" data-carousel="cene-passate" aria-label="Successivo">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>

      <div class="carousel-indicators" data-carousel="cene-passate"></div>
    </div>
  </section>

  <div class="section-divider"></div>

  <!-- I Nostri Partner -->
  <section class="partner-section">
    <div class="container">
      <div class="section-header">
        <h2>I Nostri Partner</h2>
        <p>
          Dopo cena, se lo desideri, porta con te un ricordo speciale
        </p>
      </div>

      <div class="carousel-wrapper">
        <button class="carousel-arrow carousel-arrow-left" data-carousel="partners" aria-label="Precedente">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>

        <div class="carousel-container" data-carousel="partners">
          <div class="carousel-track">
            {partners.map((partner) => (
              <div class="partner-card">
                <img
                  src={partner.logo}
                  alt={`Logo ${partner.nome} - Partner Ristorante TRE`}
                  loading="lazy"
                  decoding="async"
                  width="180"
                  height="100"
                />
              </div>
            ))}
          </div>
        </div>

        <button class="carousel-arrow carousel-arrow-right" data-carousel="partners" aria-label="Successivo">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>

      <div class="carousel-indicators" data-carousel="partners"></div>
    </div>
  </section>

  <div class="section-divider"></div>

  <!-- Prenota il Tuo Tavolo CTA -->
  <section class="cta-section cta-section-cene-tema">
    <div class="container">
      <h2>Prenota il Tuo Tavolo</h2>
      <p>
        Prenota comodamente online in pochi click o chiamaci per riservare il tuo tavolo
      </p>
      <a href="/contatti/" class="btn btn-primary">Prenota Ora</a>
    </div>
  </section>

  <div class="section-divider"></div>

  <!-- Newsletter Cene a Tema - FORM CUSTOM + BREVO -->
  <section class="newsletter-cene-section" id="newsletter-cene">
    <div class="container">
      <div class="newsletter-form-wrapper">
        
        <!-- Messaggi di stato -->
        <div id="form-error" class="form-message form-message-error" style="display: none;">
          <svg viewBox="0 0 512 512" width="20" height="20">
            <path fill="currentColor" d="M256 40c118.621 0 216 96.075 216 216 0 119.291-96.61 216-216 216-119.244 0-216-96.562-216-216 0-119.203 96.602-216 216-216m0-32C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm-11.49 120h22.979c6.823 0 12.274 5.682 11.99 12.5l-7 168c-.268 6.428-5.556 11.5-11.99 11.5h-8.979c-6.433 0-11.722-5.073-11.99-11.5l-7-168c-.283-6.818 5.167-12.5 11.99-12.5zM256 340c-15.464 0-28 12.536-28 28s12.536 28 28 28 28-12.536 28-28-12.536-28-28-28z" />
          </svg>
          <span>La tua iscrizione non può essere convalidata. Riprova.</span>
        </div>
        
        <div id="form-success" class="form-message form-message-success" style="display: none;">
          <svg viewBox="0 0 512 512" width="20" height="20">
            <path fill="currentColor" d="M256 8C119.033 8 8 119.033 8 256s111.033 248 248 248 248-111.033 248-248S392.967 8 256 8zm0 464c-118.664 0-216-96.055-216-216 0-118.663 96.055-216 216-216 118.664 0 216 96.055 216 216 0 118.663-96.055 216-216 216zm141.63-274.961L217.15 376.071c-4.705 4.667-12.303 4.637-16.97-.068l-85.878-86.572c-4.667-4.705-4.637-12.303.068-16.97l8.52-8.451c4.705-4.667 12.303-4.637 16.97.068l68.976 69.533 163.441-162.13c4.705-4.667 12.303-4.637 16.97.068l8.451 8.52c4.668 4.705 4.637 12.303-.068 16.97z" />
          </svg>
          <span>Grazie! Controlla la tua email per confermare l'iscrizione.</span>
        </div>

        <!-- Header -->
        <div class="form-header">
          <div class="form-logo">
            <img src="/img/brand/tre-logo.svg" alt="Ristorante TRE" width="100" height="100" />
          </div>
          <h2>Ricevi Anteprima Cene a Tema</h2>
          <div class="form-divider"></div>
          <p>Iscriviti per ricevere in anteprima i menù e non perderti le prossime serate</p>
        </div>

        <!-- Form che invia a Brevo tramite iframe nascosto -->
        <form id="newsletter-form" 
              action="https://c8d2f6e3.sibforms.com/serve/MUIFANv3tncnH7osbpBYwz2vOyLWFWrHEgvFIjza1AHGTUdE2ZjxGpVdBnw4x_waW8urYilQX8wfdnziQVmUxk0eoa_hMMVsDF6rcE8P44HtG6Oq88vnzYDtkiIfSGlGfDCIUMq7X-rC4xeW0glbmdfUtW5ilaSph4zl8U7rmgjnLBwbG-54YSWmrgFqbiwmclo7C4B7kaxE9P5O" 
              method="POST"
              target="brevo-iframe">
          
          <!-- Nome e Cognome -->
          <div class="form-row">
            <div class="form-group">
              <label for="NOME">Inserisci il tuo NOME *</label>
              <input type="text" id="NOME" name="NOME" placeholder="NOME" required />
            </div>
            <div class="form-group">
              <label for="COGNOME">Inserisci il tuo COGNOME *</label>
              <input type="text" id="COGNOME" name="COGNOME" placeholder="COGNOME" required />
            </div>
          </div>

          <!-- Email -->
          <div class="form-group">
            <label for="EMAIL">Inserisci il tuo indirizzo EMAIL *</label>
            <input type="email" id="EMAIL" name="EMAIL" placeholder="EMAIL" required />
          </div>

          <!-- WhatsApp - LAYOUT CORRETTO CON FLEXBOX -->
          <div class="form-group">
            <label for="SMS">Inserisci il tuo numero di WHATSAPP *</label>
            <div class="brevo-phone-field">
              <select name="SMS__COUNTRY_CODE" id="SMS_COUNTRY_CODE" class="brevo-phone-select">
                <option value="+39" selected>+39 IT</option>
                <option value="+41">+41 CH</option>
                <option value="+43">+43 AT</option>
                <option value="+33">+33 FR</option>
                <option value="+49">+49 DE</option>
                <option value="+34">+34 ES</option>
                <option value="+44">+44 GB</option>
                <option value="+1">+1 US</option>
                <option value="+32">+32 BE</option>
                <option value="+31">+31 NL</option>
                <option value="+351">+351 PT</option>
                <option value="+352">+352 LU</option>
                <option value="+377">+377 MC</option>
                <option value="+378">+378 SM</option>
                <option value="+379">+379 VA</option>
                <option value="+386">+386 SI</option>
                <option value="+385">+385 HR</option>
              </select>
              <input type="tel" id="SMS" name="SMS" placeholder="3331234567" required autocomplete="off" class="brevo-phone-number" />
            </div>
            <span class="field-hint">Il numero deve contenere tra 6 e 19 cifre (es. 3331234567)</span>
          </div>

          <div class="form-divider"></div>

          <!-- Sezione Preferenze -->
          <h3 class="section-title">Scegli quali Notizie Ricevere</h3>

          <div class="checkbox-group">
            <label class="custom-checkbox">
              <input type="checkbox" name="CENE_TEMA" value="1" />
              <span class="checkbox-box"></span>
              <span class="checkbox-content">
                <strong>Cene a Tema in Anteprima</strong>
                <small>Voglio ricevere i menù delle cene a tema in anteprima</small>
              </span>
            </label>

            <label class="custom-checkbox">
              <input type="checkbox" name="PIATTI_FUORI_LISTA" value="1" />
              <span class="checkbox-box"></span>
              <span class="checkbox-content">
                <strong>Piatti Stagionali Fuori Lista</strong>
                <small>Voglio ricevere aggiornamenti su piatti fuori lista</small>
              </span>
            </label>

            <label class="custom-checkbox">
              <input type="checkbox" name="FESTE_NAZIONALI" value="1" />
              <span class="checkbox-box"></span>
              <span class="checkbox-content">
                <strong>Feste Nazionali (Natale, Capodanno,...)</strong>
                <small>Voglio ricevere in anteprima i menù delle feste nazionali</small>
              </span>
            </label>

            <label class="custom-checkbox">
              <input type="checkbox" name="IDEE_REGALO" value="1" />
              <span class="checkbox-box"></span>
              <span class="checkbox-content">
                <strong>Idee Regalo</strong>
                <small>Voglio ricevere idee regalo per occasioni speciali</small>
              </span>
            </label>
          </div>

          <div class="form-divider"></div>

          <!-- Privacy e Consenso -->
          <div class="form-group">
            <label class="custom-checkbox checkbox-required">
              <input type="checkbox" name="OPT_IN" value="1" required />
              <span class="checkbox-box"></span>
              <span class="checkbox-content">
                <strong>Consenso alla ricezione di comunicazioni *</strong>
                <small>Accetto di ricevere le newsletter e l'informativa sulla privacy</small>
              </span>
            </label>
            <span class="field-hint">Per annullare l'iscrizione usa il link nella newsletter.</span>
          </div>

          <!-- Brevo Privacy Notice -->
          <div class="privacy-notice">
            <svg width="40" height="40" viewBox="0 0 63 63">
              <path fill="#0092FF" d="M31.54 0l1.05 3.06 3.385-.01-2.735 1.897 1.05 3.042-2.748-1.886-2.738 1.886 1.044-3.05-2.745-1.897h3.393zm13.97 3.019L46.555 6.4l3.384.01-2.743 2.101 1.048 3.387-2.752-2.1-2.752 2.1 1.054-3.382-2.745-2.105h3.385zm9.998 10.056l1.039 3.382h3.38l-2.751 2.1 1.05 3.382-2.744-2.091-2.743 2.091 1.054-3.381-2.754-2.1h3.385zM58.58 27.1l1.04 3.372h3.379l-2.752 2.096 1.05 3.387-2.744-2.091-2.75 2.092 1.054-3.387-2.747-2.097h3.376zm-3.076 14.02l1.044 3.364h3.385l-2.743 2.09 1.05 3.392-2.744-2.097-2.743 2.097 1.052-3.377-2.752-2.117 3.385-.01zm-9.985 9.91l1.045 3.364h3.393l-2.752 2.09 1.05 3.393-2.745-2.097-2.743 2.097 1.05-3.383-2.751-2.1 3.384-.01zM31.45 55.01l1.044 3.043 3.393-.008-2.752 1.9L34.19 63l-2.744-1.895-2.748 1.891 1.054-3.05-2.743-1.9h3.384zm-13.934-3.98l1.036 3.364h3.402l-2.752 2.09 1.053 3.393-2.747-2.097-2.752 2.097 1.053-3.382-2.743-2.1 3.384-.01zm-9.981-9.91l1.045 3.364h3.398l-2.748 2.09 1.05 3.392-2.753-2.1-2.752 2.096 1.053-3.382-2.743-2.102 3.384-.009zM4.466 27.1l1.038 3.372H8.88l-2.752 2.097 1.053 3.387-2.743-2.09-2.748 2.09 1.053-3.387L0 30.472h3.385zm3.069-14.025l1.045 3.382h3.395L9.23 18.56l1.05 3.381-2.752-2.09-2.752 2.09 1.053-3.381-2.744-2.1h3.384zm9.99-10.056L18.57 6.4l3.393.01-2.743 2.1 1.05 3.373-2.754-2.092-2.751 2.092 1.053-3.382-2.744-2.1h3.384zm24.938 19.394l-10-4.22a2.48 2.48 0 00-1.921 0l-10 4.22A2.529 2.529 0 0019 24.75c0 10.47 5.964 17.705 11.537 20.057a2.48 2.48 0 001.921 0C36.921 42.924 44 36.421 44 24.75a2.532 2.532 0 00-1.537-2.336zm-2.46 6.023l-9.583 9.705a.83.83 0 01-1.177 0l-5.416-5.485a.855.855 0 010-1.192l1.177-1.192a.83.83 0 011.177 0l3.65 3.697 7.819-7.916a.83.83 0 011.177 0l1.177 1.191a.843.843 0 010 1.192z"/>
            </svg>
            <p>Utilizziamo Brevo come piattaforma di marketing. Inviando questo modulo, accetti che i dati personali vengano trasferiti a Brevo per il trattamento in conformità <a href="https://www.brevo.com/it/legal/privacypolicy/" target="_blank" rel="noopener">all'Informativa sulla privacy di Brevo</a>.</p>
          </div>

          <!-- reCAPTCHA -->
          <div class="recaptcha-wrapper">
            <label>Conferma di non essere un robot *</label>
            <div class="g-recaptcha" data-sitekey="6LforPIqAAAAAEqw89kHSZ6WB3VUsIVeHEKS2z44"></div>
            <span class="field-hint">Modulo sicuro con reCAPTCHA</span>
          </div>

          <!-- Submit Button -->
          <button type="submit" class="btn btn-primary submit-btn" id="submit-btn">
            <span class="btn-text">RICEVI ANTEPRIMA</span>
            <span class="btn-loader" style="display: none;">
              <svg viewBox="0 0 512 512" width="20" height="20">
                <path fill="currentColor" d="M460.116 373.846l-20.823-12.022c-5.541-3.199-7.54-10.159-4.663-15.874 30.137-59.886 28.343-131.652-5.386-189.946-33.641-58.394-94.896-95.833-161.827-99.676C261.028 55.961 256 50.751 256 44.352V20.309c0-6.904 5.808-12.337 12.703-11.982 83.556 4.306 160.163 50.864 202.11 123.677 42.063 72.696 44.079 162.316 6.031 236.832-3.14 6.148-10.75 8.461-16.728 5.01z" />
              </svg>
            </span>
          </button>

          <!-- Hidden honeypot field -->
          <input type="text" name="email_address_check" value="" style="display: none;">
          <input type="hidden" name="locale" value="it">
        </form>

        <!-- Iframe nascosto per ricevere la risposta di Brevo -->
        <iframe name="brevo-iframe" id="brevo-iframe" style="display: none;"></iframe>
      </div>
    </div>
  </section>

  <div class="section-divider"></div>

  <!-- Sticky CTA Bottom -->
  <div class="sticky-cta-bottom" id="sticky-cta">
    <div class="sticky-cta-container">
      <div class="sticky-cta-logo">
        <img src="/img/brand/tre-logo.svg" alt="TRE" width="50" height="50" />
      </div>
      <div class="sticky-cta-content">
        <span class="sticky-cta-title">Cene a Tema</span>
        <span class="sticky-cta-subtitle">Ricevi l'anteprima</span>
      </div>
      <a href="#newsletter-cene" class="btn btn-primary sticky-cta-btn">Iscriviti</a>
    </div>
  </div>
</Layout>

<style>
  /* Hero Cene a Tema */
  .hero-cene-tema {
    background-image:
      linear-gradient(rgba(0, 0, 0, 0.62), rgba(0, 0, 0, 0.62)),
      url('/img/cene-tema/cena-tema-ristorante-pizzeria-tre-merate-hero.webp');
  }

  /* CTA Cene a Tema */
  .cta-section-cene-tema {
    background-image:
      linear-gradient(rgba(0, 0, 0, 0.65), rgba(0, 0, 0, 0.65)),
      url('/img/cene-tema/cene-tema-ristorante-pizzeria-tre-merate-prenota-tavolo.webp');
  }

  /* ===== PROSSIMA CENA SECTION ===== */
  .prossima-cena-section {
    padding: 4rem 0;
    background-color: var(--bg-white);
  }

  @media (min-width: 768px) {
    .prossima-cena-section {
      padding: 5rem 0;
    }
  }

  .prossima-cena-header {
    text-align: center;
    margin-bottom: 2rem;
  }

  .prossima-cena-label {
    display: inline-block;
    font-size: 18px;
    font-weight: 500;
    color: var(--text-dark);
    opacity: 0.7;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    margin-bottom: 0.5rem;
  }

  .prossima-cena-data {
    font-size: 20px;
    font-weight: 600;
    color: var(--text-dark);
    margin: 0;
  }

  @media (max-width: 768px) {
    .prossima-cena-label { font-size: 16px; }
    .prossima-cena-data { font-size: 18px; }
  }

  /* Menu Degustazione */
  .menu-degustazione {
    max-width: 700px;
    margin: 0 auto;
    text-align: center;
  }

  .menu-degustazione-titolo {
    font-size: 48px;
    font-weight: 600;
    color: var(--primary-color);
    margin-bottom: 3rem;
    font-style: italic;
  }

  @media (max-width: 768px) {
    .menu-degustazione-titolo {
      font-size: 35px;
      margin-bottom: 2rem;
    }
  }

  .portate-list {
    display: flex;
    flex-direction: column;
    gap: 2rem;
  }

  .portata-item { text-align: center; }

  .portata-tipo {
    font-size: 28px;
    font-weight: 600;
    color: var(--primary-color);
    margin-bottom: 0.75rem;
    text-decoration: underline;
    text-underline-offset: 4px;
  }

  .portata-piatto {
    font-size: 20px;
    font-weight: 500;
    color: var(--text-dark);
    margin-bottom: 0.5rem;
    line-height: 1.4;
  }

  .portata-abbinamento {
    font-size: 16px;
    font-weight: 400;
    color: var(--text-dark);
    opacity: 0.7;
    font-style: italic;
    margin-bottom: 0.75rem;
  }

  @media (max-width: 768px) {
    .portata-tipo { font-size: 24px; }
    .portata-piatto { font-size: 18px; }
    .portata-abbinamento { font-size: 14px; }
  }

  .portata-divider {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-top: 1rem;
  }

  .portata-divider .dot {
    width: 8px;
    height: 8px;
    background-color: var(--primary-color);
    border-radius: 50%;
  }

  .menu-prezzo {
    margin-top: 2.5rem;
    padding-top: 2rem;
    border-top: 2px solid var(--primary-pale);
  }

  .prezzo-label {
    display: block;
    font-size: 36px;
    font-weight: 700;
    color: var(--primary-color);
  }

  .prezzo-suffix {
    font-size: 18px;
    font-weight: 500;
    color: var(--text-dark);
    opacity: 0.7;
  }

  @media (max-width: 768px) {
    .prezzo-label { font-size: 28px; }
    .prezzo-suffix { font-size: 16px; }
  }

  /* ===== CENE PASSATE SECTION ===== */
  .cene-passate-section {
    padding: 4rem 0;
    background-color: var(--bg-light);
  }

  @media (min-width: 768px) {
    .cene-passate-section { padding: 5rem 0; }
  }

  .cena-passata-card {
    position: relative;
    border-radius: 12px;
    overflow: hidden;
    height: 450px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  .cena-passata-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
  }

  .cena-passata-card img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.5s ease;
  }

  .cena-passata-card:hover img { transform: scale(1.05); }

  .cena-passata-overlay {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    padding: 2rem 1.5rem;
    background: linear-gradient(to top, rgba(0, 0, 0, 0.85), rgba(0, 0, 0, 0.3), transparent);
    color: var(--text-white);
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    height: 100%;
  }

  .cena-passata-titolo {
    font-size: 24px;
    font-weight: 600;
    line-height: 1.3;
    margin-bottom: 0.5rem;
    color: var(--text-white);
  }

  .cena-passata-data {
    font-size: 16px;
    font-weight: 400;
    color: var(--text-gray);
    margin: 0;
  }

  @media (max-width: 768px) {
    .cena-passata-card { height: 420px; }
    .cena-passata-titolo { font-size: 22px; }
    .cena-passata-data { font-size: 14px; }
  }

  .carousel-track .cena-passata-card {
    flex: 0 0 calc((100% - 4rem) / 3);
  }

  @media (max-width: 1200px) {
    .carousel-track .cena-passata-card {
      flex: 0 0 calc((100% - 2rem) / 2);
    }
  }

  @media (max-width: 768px) {
    .carousel-track .cena-passata-card {
      flex: 0 0 calc(100% - (2 * var(--padding-mobile)));
    }
  }

  /* ===== PARTNER SECTION ===== */
  .partner-section {
    padding: 4rem 0;
    background-color: var(--bg-white);
  }

  @media (min-width: 768px) {
    .partner-section { padding: 5rem 0; }
  }

  .partner-card {
    background-color: transparent;
    border-radius: 8px;
    padding: 1rem 1.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 100px;
    transition: all 0.3s ease;
  }

  .partner-card:hover { transform: scale(1.05); }

  .partner-card img {
    max-width: 100%;
    max-height: 100px;
    width: auto;
    height: auto;
    object-fit: contain;
  }

  @media (max-width: 768px) {
    .partner-card {
      padding: 1rem;
      min-height: 80px;
    }
    .partner-card img { max-height: 80px; }
  }

  .carousel-track .partner-card {
    flex: 0 0 calc((100% - 6rem) / 4);
  }

  @media (max-width: 1200px) {
    .carousel-track .partner-card {
      flex: 0 0 calc((100% - 4rem) / 3);
    }
  }

  @media (max-width: 992px) {
    .carousel-track .partner-card {
      flex: 0 0 calc((100% - 2rem) / 2);
    }
  }

  @media (max-width: 768px) {
    .carousel-track .partner-card {
      flex: 0 0 calc(100% - (2 * var(--padding-mobile)));
    }
  }

  /* ===== NEWSLETTER FORM STYLES ===== */
  .newsletter-cene-section {
    padding: 4rem 0;
    background-color: var(--bg-light-orange);
  }

  @media (min-width: 768px) {
    .newsletter-cene-section { padding: 5rem 0; }
  }

  .newsletter-form-wrapper {
    max-width: 600px;
    margin: 0 auto;
    background-color: var(--bg-white);
    border-radius: 20px;
    padding: 2.5rem 2rem;
    box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
    border: 2px solid var(--primary-color);
  }

  @media (min-width: 768px) {
    .newsletter-form-wrapper { padding: 3rem; }
  }

  /* Messaggi di stato */
  .form-message {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem;
    border-radius: 8px;
    margin-bottom: 1.5rem;
    font-size: 16px;
    font-weight: 500;
    font-family: var(--font-main);
  }

  .form-message-error {
    background-color: #ffeded;
    color: #661d1d;
    border: 1px solid #ff4949;
  }

  .form-message-success {
    background-color: #e7faf0;
    color: #085229;
    border: 1px solid #13ce66;
  }

  /* Header */
  .form-header {
    text-align: center;
    margin-bottom: 2rem;
  }

  .form-logo { margin-bottom: 1.5rem; }

  .form-logo img {
    width: 100px;
    height: 100px;
    margin: 0 auto;
  }

  .form-header h2 {
    font-size: 28px;
    font-weight: 700;
    color: var(--text-dark);
    margin-bottom: 1rem;
    font-family: var(--font-main);
  }

  .form-header p {
    font-size: 18px;
    color: var(--text-dark);
    opacity: 0.8;
    margin: 0;
    font-family: var(--font-main);
  }

  @media (max-width: 768px) {
    .form-header h2 { font-size: 24px; }
    .form-header p { font-size: 16px; }
  }

  .form-divider {
    height: 1px;
    background-color: #E5EDF6;
    margin: 1.5rem 0;
  }

  /* Form Groups */
  .form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
  }

  @media (max-width: 600px) {
    .form-row { grid-template-columns: 1fr; }
  }

  .form-group { margin-bottom: 1.25rem; }

  .form-group > label {
    display: block;
    font-size: 16px;
    font-weight: 600;
    color: var(--text-dark);
    margin-bottom: 0.5rem;
    font-family: var(--font-main);
  }

  .form-group input,
  .form-group select {
    width: 100%;
    padding: 14px 16px;
    border: 2px solid #ddd;
    border-radius: 8px;
    font-family: var(--font-main);
    font-size: 16px;
    color: var(--text-dark);
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
    background-color: var(--bg-white);
    box-sizing: border-box;
  }

  .form-group input:focus,
  .form-group select:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(244, 119, 58, 0.15);
  }

  .form-group input::placeholder { color: #999; }

  /* ===== PHONE FIELD - LAYOUT CORRETTO ===== */
  .brevo-phone-field {
    display: flex;
    flex-direction: row;
    gap: 12px;
    width: 100%;
  }

  .brevo-phone-select {
    width: 130px !important;
    min-width: 130px !important;
    flex: 0 0 130px !important;
    padding: 14px 12px !important;
    border: 2px solid #ddd;
    border-radius: 8px;
    font-family: var(--font-main);
    font-size: 16px;
    color: var(--text-dark);
    background-color: var(--bg-white);
    cursor: pointer;
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
  }

  .brevo-phone-select:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(244, 119, 58, 0.15);
  }

  .brevo-phone-number {
    flex: 1 1 auto !important;
    min-width: 0 !important;
  }

  /* Mobile: stack verticalmente solo su schermi molto piccoli */
  @media (max-width: 420px) {
    .brevo-phone-field {
      flex-direction: column;
      gap: 8px;
    }
    
    .brevo-phone-select {
      width: 100% !important;
      flex: 0 0 auto !important;
    }
  }

  .field-hint {
    display: block;
    font-size: 12px;
    color: var(--text-dark);
    opacity: 0.6;
    margin-top: 0.5rem;
    font-family: var(--font-main);
  }

  /* Section Title */
  .section-title {
    font-size: 24px;
    font-weight: 700;
    color: var(--text-dark);
    text-align: center;
    margin-bottom: 1.5rem;
    font-family: var(--font-main);
  }

  @media (max-width: 768px) {
    .section-title { font-size: 20px; }
  }

  /* ===== CUSTOM CHECKBOXES ===== */
  .checkbox-group {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    margin-bottom: 1.5rem;
  }

  .custom-checkbox {
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
    cursor: pointer;
    padding: 1rem;
    background-color: var(--bg-light);
    border-radius: 8px;
    transition: background-color 0.3s ease;
  }

  .custom-checkbox:hover {
    background-color: var(--bg-light-orange);
  }

  /* Nascondo l'input nativo */
  .custom-checkbox input[type="checkbox"] {
    position: absolute;
    opacity: 0;
    width: 0;
    height: 0;
  }

  /* Box del checkbox custom */
  .checkbox-box {
    width: 24px;
    height: 24px;
    min-width: 24px;
    border: 2px solid #ccc;
    border-radius: 4px;
    background-color: #fff;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
    margin-top: 2px;
    position: relative;
  }

  /* Checkmark (nascosto di default) */
  .checkbox-box::after {
    content: '';
    width: 6px;
    height: 12px;
    border: solid white;
    border-width: 0 2.5px 2.5px 0;
    transform: rotate(45deg);
    opacity: 0;
    transition: opacity 0.2s ease;
    position: absolute;
    top: 3px;
    left: 7px;
  }

  /* Stato hover */
  .custom-checkbox:hover .checkbox-box {
    border-color: var(--primary-color);
  }

  /* Stato checked */
  .custom-checkbox input[type="checkbox"]:checked + .checkbox-box {
    background-color: var(--primary-color);
    border-color: var(--primary-color);
  }

  .custom-checkbox input[type="checkbox"]:checked + .checkbox-box::after {
    opacity: 1;
  }

  /* Contenuto del checkbox */
  .checkbox-content { flex: 1; }

  .checkbox-content strong {
    display: block;
    font-size: 16px;
    font-weight: 600;
    color: var(--text-dark);
    margin-bottom: 0.25rem;
    font-family: var(--font-main);
  }

  .checkbox-content small {
    font-size: 14px;
    color: var(--text-dark);
    opacity: 0.7;
    font-family: var(--font-main);
    display: block;
  }

  /* Checkbox required (privacy) */
  .checkbox-required {
    background-color: transparent;
    padding: 0;
  }

  .checkbox-required:hover {
    background-color: transparent;
  }

  /* Privacy Notice */
  .privacy-notice {
    display: flex;
    align-items: flex-start;
    gap: 1rem;
    padding: 1rem;
    background-color: var(--bg-light);
    border-radius: 8px;
    margin: 1.5rem 0;
  }

  .privacy-notice svg { flex-shrink: 0; }

  .privacy-notice p {
    font-size: 13px;
    line-height: 1.5;
    color: var(--text-dark);
    opacity: 0.7;
    margin: 0;
    font-family: var(--font-main);
  }

  .privacy-notice a {
    color: var(--primary-color);
    text-decoration: underline;
  }

  /* reCAPTCHA */
  .recaptcha-wrapper { margin: 1.5rem 0; }

  .recaptcha-wrapper > label {
    display: block;
    font-size: 16px;
    font-weight: 600;
    color: var(--text-dark);
    margin-bottom: 0.75rem;
    font-family: var(--font-main);
  }

  .recaptcha-wrapper .g-recaptcha {
    display: flex;
    justify-content: center;
  }

  /* Submit Button */
  .submit-btn {
    width: 100%;
    padding: 16px 24px;
    font-size: 18px;
    font-weight: 700;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    margin-top: 1rem;
  }

  .btn-loader {
    animation: spin 1s linear infinite;
  }

  @keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }

  .submit-btn:disabled {
    opacity: 0.7;
    cursor: not-allowed;
  }
</style>

<!-- reCAPTCHA Script -->
<script is:inline src="https://www.google.com/recaptcha/api.js?hl=it" async defer></script>

<script is:inline>
document.addEventListener('DOMContentLoaded', () => {
  // Inizializza i caroselli
  if (typeof Carousel !== 'undefined') {
    new Carousel('cene-passate');
    new Carousel('partners');
  }

  // Sticky CTA
  initStickyCta();

  // Form handling
  initFormHandler();
});

function initStickyCta() {
  const stickyCta = document.getElementById('sticky-cta');
  const heroSection = document.querySelector('.hero');
  const newsletterSection = document.getElementById('newsletter-cene');

  if (!stickyCta || !heroSection || !newsletterSection) return;

  const handleScroll = () => {
    const heroBottom = heroSection.getBoundingClientRect().bottom;
    const newsletterTop = newsletterSection.getBoundingClientRect().top;
    const windowHeight = window.innerHeight;
    const shouldShow = heroBottom < 0 && newsletterTop > windowHeight - 100;
    stickyCta.classList.toggle('visible', shouldShow);
  };

  window.addEventListener('scroll', handleScroll);
  handleScroll();
}

function initFormHandler() {
  const form = document.getElementById('newsletter-form');
  const iframe = document.getElementById('brevo-iframe');
  const errorMsg = document.getElementById('form-error');
  const successMsg = document.getElementById('form-success');
  const submitBtn = document.getElementById('submit-btn');
  const btnText = submitBtn?.querySelector('.btn-text');
  const btnLoader = submitBtn?.querySelector('.btn-loader');

  if (!form || !iframe) return;

  // Quando il form viene inviato
  form.addEventListener('submit', function(e) {
    // Nascondi messaggi precedenti
    errorMsg.style.display = 'none';
    successMsg.style.display = 'none';

    // Mostra loader
    if (btnText) btnText.textContent = 'Invio in corso...';
    if (btnLoader) btnLoader.style.display = 'inline-block';
    submitBtn.disabled = true;

    // Il form viene inviato normalmente all'iframe grazie a target="brevo-iframe"
  });

  // Quando l'iframe riceve una risposta (form processato)
  iframe.addEventListener('load', function() {
    // L'iframe ha caricato qualcosa - significa che il form è stato processato
    // Con Brevo, se arriva qui senza errori, assumiamo successo
    
    // Ripristina bottone
    if (btnText) btnText.textContent = 'RICEVI ANTEPRIMA';
    if (btnLoader) btnLoader.style.display = 'none';
    submitBtn.disabled = false;

    // Mostra messaggio di successo
    successMsg.style.display = 'flex';
    
    // Reset form
    form.reset();
    
    // Reset reCAPTCHA
    if (typeof grecaptcha !== 'undefined') {
      grecaptcha.reset();
    }

    // Scroll al messaggio di successo
    successMsg.scrollIntoView({ behavior: 'smooth', block: 'center' });
  });
}
</script>