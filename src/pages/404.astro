---
import Layout from "../layouts/Layout.astro";

// SEO Data - noindex per pagina 404
const seoData = {
  title: "Pagina Non Trovata - Ristorante Pizzeria TRE",
  description: "La pagina che cerchi non esiste. Torna alla home del Ristorante Pizzeria TRE a Merate o scopri i nostri menù.",
  robots: "noindex, nofollow",
  canonical: "https://www.ristorantepizzeriatre.it/404/",
  ogImage: "https://www.ristorantepizzeriatre.it/img/custom-errore/oh-no-ci-siamo-persi-la-tua-pizza-pagina-quattrocentoquattro.webp",
  preloadImage: "/img/custom-errore/oh-no-ci-siamo-persi-la-tua-pizza-pagina-quattrocentoquattro.webp",
};
---

<Layout 
  title={seoData.title}
  description={seoData.description}
  robots={seoData.robots}
  canonical={seoData.canonical}
  ogImage={seoData.ogImage}
  preloadImage={seoData.preloadImage}
>
  <!-- Hero Section 404 -->
  <section class="hero hero-404">
    <div class="container hero-content">
      <h1>Oh no, ci siamo persi<br />la tua pizza!</h1>
      <p>
        La pagina che cerchi si è persa per strada. Torna<br />
        alla home o dai un'occhiata ai nostri menù!
      </p>
      <div class="hero-buttons">
        <a href="https://www.ristorantepizzeriatre.it" class="btn btn-primary">Prenota Ora</a>
        <a href="/#scopri-menu" class="btn btn-outline">Scopri il Menù</a>
      </div>
    </div>
  </section>

  <!-- Sticky CTA Bottom (placeholder - appare dopo scroll) -->
  <div class="sticky-cta-bottom" id="sticky-cta">
    <div class="sticky-cta-container">
      <div class="sticky-cta-logo">
        <img src="/img/brand/tre-logo.svg" alt="TRE" width="50" height="50" />
      </div>
      <div class="sticky-cta-content">
        <span class="sticky-cta-title">Ristorante Pizzeria TRE</span>
        <span class="sticky-cta-subtitle">Scopri il nostro Menù e i nostri Servizi personalizzati.</span>
      </div>
      <a href="/#scopri-menu" class="btn btn-primary sticky-cta-btn">Scopri il Menù</a>
    </div>
  </div>
</Layout>

<style>
  /* Hero 404 - background con immagine pizzaiolo */
  .hero-404 {
    background-image:
      linear-gradient(rgba(0, 0, 0, 0.45), rgba(0, 0, 0, 0.45)),
      url('/img/custom-errore/oh-no-ci-siamo-persi-la-tua-pizza-pagina-quattrocentoquattro.webp');
    background-position: center top;
    background-size: cover;
    min-height: clamp(550px, 70vh, 750px);
  }

  @media (max-width: 768px) {
    .hero-404 {
      min-height: clamp(500px, 65vh, 680px);
      background-position: center 20%;
    }
  }

  /* Testo hero più leggibile */
  .hero-404 h1 {
    text-shadow: 0 2px 20px rgba(0, 0, 0, 0.4);
  }

  .hero-404 p {
    text-shadow: 0 1px 10px rgba(0, 0, 0, 0.3);
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const stickyCta = document.getElementById('sticky-cta');
    const heroSection = document.querySelector('.hero-404');

    if (!stickyCta || !heroSection) return;

    const updateStickyCta = () => {
      const heroBottom = heroSection.getBoundingClientRect().bottom;

      // Mostra sticky CTA quando l'hero esce dalla viewport
      if (heroBottom < 0) {
        stickyCta.classList.add('visible');
      } else {
        stickyCta.classList.remove('visible');
      }
    };

    // Scroll event listener con requestAnimationFrame
    let ticking = false;
    window.addEventListener('scroll', () => {
      if (!ticking) {
        window.requestAnimationFrame(() => {
          updateStickyCta();
          ticking = false;
        });
        ticking = true;
      }
    });

    // Initial call
    updateStickyCta();
  });
</script>