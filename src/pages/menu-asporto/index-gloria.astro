---
import Layout from "../../layouts/Layout.astro";
import { fetchSheetData, filterByCategory, formatPrice, formatAllergens, SHEET_GIDS } from "../../utils/googleSheets";
import CapacityBanner from "../../components/CapacityBanner.astro";

// Fetch dati da Google Sheets (avviene solo al BUILD TIME)
const allItems = await fetchSheetData(SHEET_GIDS.menuAsporto);

// Raggruppa per categoria
const pizzeTradizionali = filterByCategory(allItems, 'pizze-tradizionali');
const pizzeSpeciali = filterByCategory(allItems, 'pizze-speciali');
const filoncini = filterByCategory(allItems, 'filoncini');
const pizzeVegetariane = filterByCategory(allItems, 'pizze-vegetariane');
const antipasti = filterByCategory(allItems, 'antipasti');
const primi = filterByCategory(allItems, 'primi');
const secondi = filterByCategory(allItems, 'secondi');
const griglia = filterByCategory(allItems, 'griglia');
const insalatone = filterByCategory(allItems, 'insalatone');
const contorni = filterByCategory(allItems, 'contorni');
const dessert = filterByCategory(allItems, 'dessert');
const bevande = filterByCategory(allItems, 'bevande');
const birre = filterByCategory(allItems, 'birre');
const vini = filterByCategory(allItems, 'vini');

// GloriaFood Widget IDs
const gloriaFoodCuid = "ab06e065-1a81-45d4-9159-66102a943d6d";
const gloriaFoodRuid = "235bfa64-cb7a-4876-a1d9-739c5af0be8b";

// SEO Data
const seoData = {
  title: "Menù d'Asporto - Ordina Online e Ritira - TRE Grill + Pizzeria",
  description: "Ordina online i tuoi piatti preferiti. Pizze, primi e secondi preparati con cura. Seleziona l'orario di ritiro e paga comodamente al ritiro!",
  canonical: "https://www.ristorantepizzeriatre.it/menu-asporto/",
  ogImage: "https://www.ristorantepizzeriatre.it/img/menu-asporto/menu-asporto-ristorante-pizzeria-tre-merate-hero.webp",
  preloadImage: "/img/menu-asporto/menu-asporto-ristorante-pizzeria-tre-merate-hero.webp",
};

// Schema.org per Menu + BreadcrumbList
const schemaOrg = {
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "Menu",
      "@id": "https://www.ristorantepizzeriatre.it/menu-asporto/#menu",
      "name": "Menù d'Asporto - Ristorante Pizzeria TRE",
      "description": "Menù d'asporto con pizze cotte nel forno a legna, primi piatti, secondi, contorni e dessert. Ordina online e ritira al ristorante.",
      "url": "https://www.ristorantepizzeriatre.it/menu-asporto/",
      "mainEntityOfPage": "https://www.ristorantepizzeriatre.it/menu-asporto/",
      "inLanguage": "it-IT",
      "offers": {
        "@type": "Offer",
        "priceCurrency": "EUR",
        "availability": "https://schema.org/InStock"
      },
      "hasMenuSection": [
        {
          "@type": "MenuSection",
          "name": "Pizze Tradizionali",
          "description": "Pizze classiche cotte nel forno a legna con impasto a lunga lievitazione"
        },
        {
          "@type": "MenuSection",
          "name": "Pizze Speciali",
          "description": "Pizze con ingredienti premium e selezionati"
        },
        {
          "@type": "MenuSection",
          "name": "Filoncini",
          "description": "Calzoni croccanti all'esterno e soffici all'interno"
        },
        {
          "@type": "MenuSection",
          "name": "Pizze Vegetariane e Vegane",
          "description": "Pizze preparate con ingredienti genuini e naturali"
        },
        {
          "@type": "MenuSection",
          "name": "Antipasti",
          "description": "Selezione di antipasti della tradizione italiana"
        },
        {
          "@type": "MenuSection",
          "name": "Primi Piatti",
          "description": "Risotti e paste fresche con ingredienti di stagione"
        },
        {
          "@type": "MenuSection",
          "name": "Secondi Piatti",
          "description": "Secondi di pesce e carne preparati con cura"
        },
        {
          "@type": "MenuSection",
          "name": "Carne alla Griglia",
          "description": "Tagliate e carni pregiate cotte alla griglia"
        },
        {
          "@type": "MenuSection",
          "name": "Insalatone",
          "description": "Insalate complete e gustose"
        },
        {
          "@type": "MenuSection",
          "name": "Contorni",
          "description": "Accompagnamenti e verdure"
        },
        {
          "@type": "MenuSection",
          "name": "Dessert",
          "description": "Dolci della tradizione italiana"
        },
        {
          "@type": "MenuSection",
          "name": "Bevande",
          "description": "Bibite e soft drink"
        },
        {
          "@type": "MenuSection",
          "name": "Birre",
          "description": "Selezione di birre artigianali italiane"
        },
        {
          "@type": "MenuSection",
          "name": "Vini",
          "description": "Carta vini con etichette selezionate"
        }
      ]
    },
    {
      "@type": "BreadcrumbList",
      "@id": "https://www.ristorantepizzeriatre.it/menu-asporto/#breadcrumb",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": "https://www.ristorantepizzeriatre.it/"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Menù d'Asporto",
          "item": "https://www.ristorantepizzeriatre.it/menu-asporto/"
        }
      ]
    },
    {
      "@type": "WebPage",
      "@id": "https://www.ristorantepizzeriatre.it/menu-asporto/#webpage",
      "url": "https://www.ristorantepizzeriatre.it/menu-asporto/",
      "name": "Menù d'Asporto - Ordina Online e Ritira | Ristorante Pizzeria TRE Merate",
      "isPartOf": {
        "@id": "https://www.ristorantepizzeriatre.it/#website"
      },
      "primaryImageOfPage": {
        "@type": "ImageObject",
        "url": "https://www.ristorantepizzeriatre.it/img/menu-asporto/menu-asporto-ristorante-pizzeria-tre-merate-hero.webp"
      },
      "breadcrumb": {
        "@id": "https://www.ristorantepizzeriatre.it/menu-asporto/#breadcrumb"
      },
      "inLanguage": "it-IT"
    }
  ]
};

// Menu navigation items - costruito dinamicamente in base alle categorie presenti
const menuNav = [
  { id: "pizze-tradizionali", label: "Pizze tradizionali", items: pizzeTradizionali },
  { id: "pizze-speciali", label: "Pizze speciali", items: pizzeSpeciali },
  { id: "filoncini", label: "Filoncini", items: filoncini },
  { id: "pizze-vegetariane", label: "Pizze vegetariane", items: pizzeVegetariane },
  { id: "antipasti", label: "Antipasti", items: antipasti },
  { id: "primi", label: "Primi", items: primi },
  { id: "secondi", label: "Secondi", items: secondi },
  { id: "griglia", label: "Griglia", items: griglia },
  { id: "insalatone", label: "Insalatone", items: insalatone },
  { id: "contorni", label: "Contorni", items: contorni },
  { id: "dessert", label: "Dessert", items: dessert },
  { id: "bevande", label: "Bevande", items: bevande },
  { id: "birre", label: "Birre", items: birre },
  { id: "vini", label: "Vini", items: vini }
].filter(nav => nav.items.length > 0);

// Helper per determinare il percorso immagine in base alla categoria
const getImagePath = (categoria: string, slug: string) => {
  if (['pizze-tradizionali', 'pizze-speciali', 'filoncini', 'pizze-vegetariane'].includes(categoria)) {
    return `/img/menu-asporto/pizze/${slug}`;
  } else if (['bevande'].includes(categoria)) {
    return `/img/menu-asporto/bibite/${slug}`;
  } else if (['birre'].includes(categoria)) {
    return `/img/menu-asporto/birre/${slug}`;
  } else if (['vini'].includes(categoria)) {
    return `/img/menu-asporto/vini/${slug}`;
  } else {
    return `/img/menu-asporto/cucina/${slug}`;
  }
};

// Helper per formattare la descrizione con allergeni
const formatDesc = (item: any) => {
  let desc = item.descrizione || '';
  if (item.allergeni && item.allergeni.trim()) {
    desc += desc ? ` (${item.allergeni})` : `(${item.allergeni})`;
  }
  return desc;
};
---

<Layout 
  title={seoData.title}
  description={seoData.description}
  canonical={seoData.canonical}
  ogImage={seoData.ogImage}
  preloadImage={seoData.preloadImage}
>
  <!-- Schema.org JSON-LD -->
  <Fragment slot="schema">
    <script type="application/ld+json" set:html={JSON.stringify(schemaOrg)} />
  </Fragment>

  <!-- Hero Section -->
  <section class="hero hero-menu-asporto">
    <div class="container hero-content">
      <h1>Menù d'Asporto</h1>
      <p>
        Ordina online i tuoi piatti preferiti e gustali<br />
        comodamente a casa tua.
      </p>
      <div class="hero-buttons">
        <a href="#seleziona-piatti" class="btn btn-primary">Scopri il Menù</a>
        <a href="#come-funziona" class="btn btn-outline">Come funziona</a>
      </div>
    </div>
  </section>

  <!-- Breadcrumb -->
  <nav class="breadcrumb-nav" aria-label="Breadcrumb">
    <div class="container">
      <ol class="breadcrumb">
        <li><a href="/">Home</a></li>
        <li aria-current="page">Menù d'Asporto</li>
      </ol>
    </div>
  </nav>

  <!-- NUOVO: Banner Capacità (solo asporto) -->
  <section class="capacity-alert-section">
    <div class="container">
      <CapacityBanner tipo="asporto" />
    </div>
  </section>


  <!-- Come Funziona -->
  <section class="come-funziona-section" id="come-funziona">
    <div class="container">
      <div class="come-funziona-grid">
        <div class="come-funziona-content">
          <h2>Come Funziona</h2>
          <p class="come-funziona-intro">
            Ordina online, seleziona l'orario di ritiro e passa a ritirare il tuo ordine già pronto. Paghi comodamente al ritiro!
          </p>
          
          <ul class="come-funziona-steps">
            <li>
              <strong>Scegli i tuoi piatti:</strong> sfoglia il nostro menù d'asporto e aggiungi al carrello i piatti che vuoi ordinare
            </li>
            <li>
              <strong>Seleziona l'orario di ritiro:</strong> scegli l'orario più comodo per ritirare il tuo ordine
            </li>
            <li>
              <strong>Conferma l'ordine:</strong> ricevi la conferma via email con il riepilogo del tuo ordine
            </li>
            <li>
              <strong>Ritira e paga:</strong> ritira il tuo ordine già pronto e paga comodamente al ritiro
            </li>
          </ul>
          
          <div class="come-funziona-cta">
            <span 
              class="btn btn-primary btn-gloriafood"
              data-glf-cuid={gloriaFoodCuid}
              data-glf-ruid={gloriaFoodRuid}
            >
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M9 22C9.55228 22 10 21.5523 10 21C10 20.4477 9.55228 20 9 20C8.44772 20 8 20.4477 8 21C8 21.5523 8.44772 22 9 22Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M20 22C20.5523 22 21 21.5523 21 21C21 20.4477 20.5523 20 20 20C19.4477 20 19 20.4477 19 21C19 21.5523 19.4477 22 20 22Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M1 1H5L7.68 14.39C7.77144 14.8504 8.02191 15.264 8.38755 15.5583C8.75318 15.8526 9.2107 16.009 9.68 16H19.4C19.8693 16.009 20.3268 15.8526 20.6925 15.5583C21.0581 15.264 21.3086 14.8504 21.4 14.39L23 6H6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              Ordina Online
            </span>
            <a href="https://wa.me/393517701704" target="_blank" class="btn btn-whatsapp">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L0 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
              </svg>
              WhatsApp
            </a>
          </div>
        </div>
        <div class="come-funziona-image">
          <img 
            src="/img/menu-asporto/menu-asporto-ristorante-pizzeria-tre-merate-come-funziona.webp" 
            alt="Come funziona servizio asporto ristorante pizzeria tre merate"
            loading="lazy"
            decoding="async"
            width="600"
            height="400"
          />
        </div>
      </div>

      <!-- Steps Visual -->
      <div class="come-funziona-visual">
        <div class="step-visual">
          <div class="step-number">1</div>
          <span class="step-label">Scegli i Piatti</span>
        </div>
        <div class="step-connector"></div>
        <div class="step-visual">
          <div class="step-number">2</div>
          <span class="step-label">Scegli l'Orario</span>
        </div>
        <div class="step-connector"></div>
        <div class="step-visual">
          <div class="step-number">3</div>
          <span class="step-label">Conferma</span>
        </div>
        <div class="step-connector"></div>
        <div class="step-visual">
          <div class="step-number">4</div>
          <span class="step-label">Ritira e Paga</span>
        </div>
      </div>
    </div>
  </section>

  <div class="section-divider"></div>

  <!-- Menu Secondario Sticky -->
  <nav class="submenu-sticky" id="submenu-sticky">
    <div class="container">
      <ul class="submenu-list">
        {menuNav.map((item, idx) => (
          <li>
            <a href={`#${item.id}`} class={`submenu-link ${idx === 0 ? 'active' : ''}`}>
              {item.label}
            </a>
          </li>
        ))}
      </ul>
    </div>
  </nav>

  <!-- Seleziona i Tuoi Piatti -->
  <section class="seleziona-piatti-section" id="seleziona-piatti">
    <div class="container">
      <div class="section-header">
        <h2>Seleziona i Tuoi Piatti</h2>
        <p>
          Scegli tra le pizze cotte nel forno a legna, primi piatti, secondi e contorni,<br />
          tutti preparati con ingredienti freschi e di qualità.
        </p>
      </div>
    </div>
  </section>

  <!-- Pizze Tradizionali -->
  {pizzeTradizionali.length > 0 && (
    <section class="asporto-menu-section" id="pizze-tradizionali">
      <div class="container">
        <h3 class="asporto-section-title">Pizze Tradizionali</h3>
        <div class="asporto-grid">
          {pizzeTradizionali.map((item) => (
            <div class="asporto-card" data-has-desc={formatDesc(item) ? "true" : "false"}>
              <div class="asporto-card-inner">
                <div class="asporto-card-front">
                  <div class="asporto-card-image" 
                       data-detail-img={`${getImagePath(item.categoria, item.slug)}-dettaglio.webp`}
                       data-item-name={item.nome}>
                    <img 
                      src={`${getImagePath(item.categoria, item.slug)}.webp`}
                      alt={`${item.nome} pizzeria tre merate`}
                      loading="lazy"
                      decoding="async"
                      width="280"
                      height="350"
                    />
                    <div class="asporto-zoom-overlay">
                      <img 
                        src={`${getImagePath(item.categoria, item.slug)}-dettaglio.webp`}
                        alt={`${item.nome} dettaglio`}
                        loading="lazy"
                      />
                    </div>
                    <span class="asporto-zoom-hint">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"/>
                        <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <path d="M11 8v6M8 11h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    </span>
                  </div>
                  <div class="asporto-card-info">
                    <h4 class="asporto-card-name">{item.nome}</h4>
                    <span class="asporto-card-price">{formatPrice(item.prezzo)}</span>
                  </div>
                  {formatDesc(item) && (
                    <button class="asporto-card-info-btn" aria-label="Mostra ingredienti">
                      <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                        <path d="M12 16v-4M12 8h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    </button>
                  )}
                </div>
                <div class="asporto-card-back">
                  <div class="asporto-card-back-content">
                    <h4 class="asporto-card-name">{item.nome}</h4>
                    <p class="asporto-card-desc">{formatDesc(item)}</p>
                    <span class="asporto-card-price">{formatPrice(item.prezzo)}</span>
                  </div>
                  <button class="asporto-card-close-btn" aria-label="Chiudi">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                      <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>
  )}

  {pizzeTradizionali.length > 0 && <div class="section-divider"></div>}

  <!-- Pizze Speciali -->
  {pizzeSpeciali.length > 0 && (
    <section class="asporto-menu-section asporto-menu-section-alt" id="pizze-speciali">
      <div class="container">
        <h3 class="asporto-section-title">Pizze Speciali</h3>
        <div class="asporto-grid">
          {pizzeSpeciali.map((item) => (
            <div class="asporto-card" data-has-desc={formatDesc(item) ? "true" : "false"}>
              <div class="asporto-card-inner">
                <div class="asporto-card-front">
                  <div class="asporto-card-image"
                       data-detail-img={`${getImagePath(item.categoria, item.slug)}-dettaglio.webp`}
                       data-item-name={item.nome}>
                    <img 
                      src={`${getImagePath(item.categoria, item.slug)}.webp`}
                      alt={`${item.nome} pizzeria tre merate`}
                      loading="lazy"
                      decoding="async"
                      width="280"
                      height="350"
                    />
                    <div class="asporto-zoom-overlay">
                      <img 
                        src={`${getImagePath(item.categoria, item.slug)}-dettaglio.webp`}
                        alt={`${item.nome} dettaglio`}
                        loading="lazy"
                      />
                    </div>
                    <span class="asporto-zoom-hint">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"/>
                        <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <path d="M11 8v6M8 11h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    </span>
                  </div>
                  <div class="asporto-card-info">
                    <h4 class="asporto-card-name">{item.nome}</h4>
                    <span class="asporto-card-price">{formatPrice(item.prezzo)}</span>
                  </div>
                  {formatDesc(item) && (
                    <button class="asporto-card-info-btn" aria-label="Mostra ingredienti">
                      <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                        <path d="M12 16v-4M12 8h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    </button>
                  )}
                </div>
                <div class="asporto-card-back">
                  <div class="asporto-card-back-content">
                    <h4 class="asporto-card-name">{item.nome}</h4>
                    <p class="asporto-card-desc">{formatDesc(item)}</p>
                    <span class="asporto-card-price">{formatPrice(item.prezzo)}</span>
                  </div>
                  <button class="asporto-card-close-btn" aria-label="Chiudi">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                      <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>
  )}

  {pizzeSpeciali.length > 0 && <div class="section-divider"></div>}

  <!-- Filoncini -->
  {filoncini.length > 0 && (
    <section class="asporto-menu-section" id="filoncini">
      <div class="container">
        <h3 class="asporto-section-title">Filoncini</h3>
        <div class="asporto-grid">
          {filoncini.map((item) => (
            <div class="asporto-card" data-has-desc={formatDesc(item) ? "true" : "false"}>
              <div class="asporto-card-inner">
                <div class="asporto-card-front">
                  <div class="asporto-card-image"
                       data-detail-img={`${getImagePath(item.categoria, item.slug)}-dettaglio.webp`}
                       data-item-name={item.nome}>
                    <img 
                      src={`${getImagePath(item.categoria, item.slug)}.webp`}
                      alt={`filoncino ${item.nome} pizzeria tre merate`}
                      loading="lazy"
                      decoding="async"
                      width="280"
                      height="350"
                    />
                    <div class="asporto-zoom-overlay">
                      <img 
                        src={`${getImagePath(item.categoria, item.slug)}-dettaglio.webp`}
                        alt={`${item.nome} dettaglio`}
                        loading="lazy"
                      />
                    </div>
                    <span class="asporto-zoom-hint">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"/>
                        <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <path d="M11 8v6M8 11h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    </span>
                  </div>
                  <div class="asporto-card-info">
                    <h4 class="asporto-card-name">{item.nome}</h4>
                    <span class="asporto-card-price">{formatPrice(item.prezzo)}</span>
                  </div>
                  {formatDesc(item) && (
                    <button class="asporto-card-info-btn" aria-label="Mostra ingredienti">
                      <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                        <path d="M12 16v-4M12 8h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    </button>
                  )}
                </div>
                <div class="asporto-card-back">
                  <div class="asporto-card-back-content">
                    <h4 class="asporto-card-name">{item.nome}</h4>
                    <p class="asporto-card-desc">{formatDesc(item)}</p>
                    <span class="asporto-card-price">{formatPrice(item.prezzo)}</span>
                  </div>
                  <button class="asporto-card-close-btn" aria-label="Chiudi">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                      <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>
  )}

  {filoncini.length > 0 && <div class="section-divider"></div>}

  <!-- Pizze Vegetariane -->
  {pizzeVegetariane.length > 0 && (
    <section class="asporto-menu-section asporto-menu-section-alt" id="pizze-vegetariane">
      <div class="container">
        <h3 class="asporto-section-title">Pizze Vegetariane e Vegane</h3>
        <div class="asporto-grid">
          {pizzeVegetariane.map((item) => (
            <div class="asporto-card" data-has-desc={formatDesc(item) ? "true" : "false"}>
              <div class="asporto-card-inner">
                <div class="asporto-card-front">
                  <div class="asporto-card-image"
                       data-detail-img={`${getImagePath(item.categoria, item.slug)}-dettaglio.webp`}
                       data-item-name={item.nome}>
                    <img 
                      src={`${getImagePath(item.categoria, item.slug)}.webp`}
                      alt={`${item.nome} pizzeria tre merate`}
                      loading="lazy"
                      decoding="async"
                      width="280"
                      height="350"
                    />
                    <div class="asporto-zoom-overlay">
                      <img 
                        src={`${getImagePath(item.categoria, item.slug)}-dettaglio.webp`}
                        alt={`${item.nome} dettaglio`}
                        loading="lazy"
                      />
                    </div>
                    <span class="asporto-zoom-hint">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"/>
                        <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <path d="M11 8v6M8 11h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    </span>
                  </div>
                  <div class="asporto-card-info">
                    <h4 class="asporto-card-name">{item.nome}</h4>
                    <span class="asporto-card-price">{formatPrice(item.prezzo)}</span>
                  </div>
                  {formatDesc(item) && (
                    <button class="asporto-card-info-btn" aria-label="Mostra ingredienti">
                      <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                        <path d="M12 16v-4M12 8h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    </button>
                  )}
                </div>
                <div class="asporto-card-back">
                  <div class="asporto-card-back-content">
                    <h4 class="asporto-card-name">{item.nome}</h4>
                    <p class="asporto-card-desc">{formatDesc(item)}</p>
                    <span class="asporto-card-price">{formatPrice(item.prezzo)}</span>
                  </div>
                  <button class="asporto-card-close-btn" aria-label="Chiudi">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                      <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>
  )}

  {pizzeVegetariane.length > 0 && <div class="section-divider"></div>}

  <!-- Antipasti -->
  {antipasti.length > 0 && (
    <section class="asporto-menu-section" id="antipasti">
      <div class="container">
        <h3 class="asporto-section-title">Antipasti</h3>
        <div class="asporto-grid">
          {antipasti.map((item) => (
            <div class="asporto-card" data-has-desc={formatDesc(item) ? "true" : "false"}>
              <div class="asporto-card-inner">
                <div class="asporto-card-front">
                  <div class="asporto-card-image"
                       data-detail-img={`${getImagePath(item.categoria, item.slug)}-dettaglio.webp`}
                       data-item-name={item.nome}>
                    <img 
                      src={`${getImagePath(item.categoria, item.slug)}.webp`}
                      alt={`${item.nome} ristorante pizzeria tre merate`}
                      loading="lazy"
                      decoding="async"
                      width="280"
                      height="350"
                    />
                    <div class="asporto-zoom-overlay">
                      <img 
                        src={`${getImagePath(item.categoria, item.slug)}-dettaglio.webp`}
                        alt={`${item.nome} dettaglio`}
                        loading="lazy"
                      />
                    </div>
                    <span class="asporto-zoom-hint">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"/>
                        <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <path d="M11 8v6M8 11h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    </span>
                  </div>
                  <div class="asporto-card-info">
                    <h4 class="asporto-card-name">{item.nome}</h4>
                    <span class="asporto-card-price">{formatPrice(item.prezzo)}</span>
                  </div>
                  {formatDesc(item) && (
                    <button class="asporto-card-info-btn" aria-label="Mostra descrizione">
                      <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                        <path d="M12 16v-4M12 8h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    </button>
                  )}
                </div>
                <div class="asporto-card-back">
                  <div class="asporto-card-back-content">
                    <h4 class="asporto-card-name">{item.nome}</h4>
                    <p class="asporto-card-desc">{formatDesc(item)}</p>
                    <span class="asporto-card-price">{formatPrice(item.prezzo)}</span>
                  </div>
                  <button class="asporto-card-close-btn" aria-label="Chiudi">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                      <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>
  )}

  {antipasti.length > 0 && <div class="section-divider"></div>}

  <!-- Primi Piatti -->
  {primi.length > 0 && (
    <section class="asporto-menu-section asporto-menu-section-alt" id="primi">
      <div class="container">
        <h3 class="asporto-section-title">Primi Piatti</h3>
        <div class="asporto-grid">
          {primi.map((item) => (
            <div class="asporto-card" data-has-desc={formatDesc(item) ? "true" : "false"}>
              <div class="asporto-card-inner">
                <div class="asporto-card-front">
                  <div class="asporto-card-image"
                       data-detail-img={`${getImagePath(item.categoria, item.slug)}-dettaglio.webp`}
                       data-item-name={item.nome}>
                    <img 
                      src={`${getImagePath(item.categoria, item.slug)}.webp`}
                      alt={`${item.nome} ristorante pizzeria tre merate`}
                      loading="lazy"
                      decoding="async"
                      width="280"
                      height="350"
                    />
                    <div class="asporto-zoom-overlay">
                      <img 
                        src={`${getImagePath(item.categoria, item.slug)}-dettaglio.webp`}
                        alt={`${item.nome} dettaglio`}
                        loading="lazy"
                      />
                    </div>
                    <span class="asporto-zoom-hint">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"/>
                        <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <path d="M11 8v6M8 11h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    </span>
                  </div>
                  <div class="asporto-card-info">
                    <h4 class="asporto-card-name">{item.nome}</h4>
                    <span class="asporto-card-price">{formatPrice(item.prezzo)}</span>
                  </div>
                  {formatDesc(item) && (
                    <button class="asporto-card-info-btn" aria-label="Mostra descrizione">
                      <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                        <path d="M12 16v-4M12 8h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    </button>
                  )}
                </div>
                <div class="asporto-card-back">
                  <div class="asporto-card-back-content">
                    <h4 class="asporto-card-name">{item.nome}</h4>
                    <p class="asporto-card-desc">{formatDesc(item)}</p>
                    <span class="asporto-card-price">{formatPrice(item.prezzo)}</span>
                  </div>
                  <button class="asporto-card-close-btn" aria-label="Chiudi">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                      <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>
  )}

  {primi.length > 0 && <div class="section-divider"></div>}

  <!-- Secondi Piatti -->
  {secondi.length > 0 && (
    <section class="asporto-menu-section" id="secondi">
      <div class="container">
        <h3 class="asporto-section-title">Secondi Piatti</h3>
        <div class="asporto-grid">
          {secondi.map((item) => (
            <div class="asporto-card" data-has-desc={formatDesc(item) ? "true" : "false"}>
              <div class="asporto-card-inner">
                <div class="asporto-card-front">
                  <div class="asporto-card-image"
                       data-detail-img={`${getImagePath(item.categoria, item.slug)}-dettaglio.webp`}
                       data-item-name={item.nome}>
                    <img 
                      src={`${getImagePath(item.categoria, item.slug)}.webp`}
                      alt={`${item.nome} ristorante pizzeria tre merate`}
                      loading="lazy"
                      decoding="async"
                      width="280"
                      height="350"
                    />
                    <div class="asporto-zoom-overlay">
                      <img 
                        src={`${getImagePath(item.categoria, item.slug)}-dettaglio.webp`}
                        alt={`${item.nome} dettaglio`}
                        loading="lazy"
                      />
                    </div>
                    <span class="asporto-zoom-hint">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"/>
                        <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <path d="M11 8v6M8 11h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    </span>
                  </div>
                  <div class="asporto-card-info">
                    <h4 class="asporto-card-name">{item.nome}</h4>
                    <span class="asporto-card-price">{formatPrice(item.prezzo)}</span>
                  </div>
                  {formatDesc(item) && (
                    <button class="asporto-card-info-btn" aria-label="Mostra descrizione">
                      <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                        <path d="M12 16v-4M12 8h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    </button>
                  )}
                </div>
                <div class="asporto-card-back">
                  <div class="asporto-card-back-content">
                    <h4 class="asporto-card-name">{item.nome}</h4>
                    <p class="asporto-card-desc">{formatDesc(item)}</p>
                    <span class="asporto-card-price">{formatPrice(item.prezzo)}</span>
                  </div>
                  <button class="asporto-card-close-btn" aria-label="Chiudi">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                      <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>
  )}

  {secondi.length > 0 && <div class="section-divider"></div>}

  <!-- Carne alla Griglia -->
  {griglia.length > 0 && (
    <section class="asporto-menu-section asporto-menu-section-alt" id="griglia">
      <div class="container">
        <h3 class="asporto-section-title">Carne alla Griglia</h3>
        <div class="asporto-grid">
          {griglia.map((item) => (
            <div class="asporto-card" data-has-desc={formatDesc(item) ? "true" : "false"}>
              <div class="asporto-card-inner">
                <div class="asporto-card-front">
                  <div class="asporto-card-image"
                       data-detail-img={`${getImagePath(item.categoria, item.slug)}-dettaglio.webp`}
                       data-item-name={item.nome}>
                    <img 
                      src={`${getImagePath(item.categoria, item.slug)}.webp`}
                      alt={`${item.nome} ristorante pizzeria tre merate`}
                      loading="lazy"
                      decoding="async"
                      width="280"
                      height="350"
                    />
                    <div class="asporto-zoom-overlay">
                      <img 
                        src={`${getImagePath(item.categoria, item.slug)}-dettaglio.webp`}
                        alt={`${item.nome} dettaglio`}
                        loading="lazy"
                      />
                    </div>
                    <span class="asporto-zoom-hint">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"/>
                        <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <path d="M11 8v6M8 11h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    </span>
                  </div>
                  <div class="asporto-card-info">
                    <h4 class="asporto-card-name">{item.nome}</h4>
                    <span class="asporto-card-price">{formatPrice(item.prezzo)}</span>
                  </div>
                  {formatDesc(item) && (
                    <button class="asporto-card-info-btn" aria-label="Mostra descrizione">
                      <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                        <path d="M12 16v-4M12 8h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    </button>
                  )}
                </div>
                <div class="asporto-card-back">
                  <div class="asporto-card-back-content">
                    <h4 class="asporto-card-name">{item.nome}</h4>
                    <p class="asporto-card-desc">{formatDesc(item)}</p>
                    <span class="asporto-card-price">{formatPrice(item.prezzo)}</span>
                  </div>
                  <button class="asporto-card-close-btn" aria-label="Chiudi">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                      <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>
  )}

  {griglia.length > 0 && <div class="section-divider"></div>}

  <!-- Insalatone -->
  {insalatone.length > 0 && (
    <section class="asporto-menu-section" id="insalatone">
      <div class="container">
        <h3 class="asporto-section-title">Insalatone</h3>
        <div class="asporto-grid">
          {insalatone.map((item) => (
            <div class="asporto-card" data-has-desc={formatDesc(item) ? "true" : "false"}>
              <div class="asporto-card-inner">
                <div class="asporto-card-front">
                  <div class="asporto-card-image"
                       data-detail-img={`${getImagePath(item.categoria, item.slug)}-dettaglio.webp`}
                       data-item-name={item.nome}>
                    <img 
                      src={`${getImagePath(item.categoria, item.slug)}.webp`}
                      alt={`${item.nome} ristorante pizzeria tre merate`}
                      loading="lazy"
                      decoding="async"
                      width="280"
                      height="350"
                    />
                    <div class="asporto-zoom-overlay">
                      <img 
                        src={`${getImagePath(item.categoria, item.slug)}-dettaglio.webp`}
                        alt={`${item.nome} dettaglio`}
                        loading="lazy"
                      />
                    </div>
                    <span class="asporto-zoom-hint">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"/>
                        <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <path d="M11 8v6M8 11h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    </span>
                  </div>
                  <div class="asporto-card-info">
                    <h4 class="asporto-card-name">{item.nome}</h4>
                    <span class="asporto-card-price">{formatPrice(item.prezzo)}</span>
                  </div>
                  {formatDesc(item) && (
                    <button class="asporto-card-info-btn" aria-label="Mostra descrizione">
                      <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                        <path d="M12 16v-4M12 8h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    </button>
                  )}
                </div>
                <div class="asporto-card-back">
                  <div class="asporto-card-back-content">
                    <h4 class="asporto-card-name">{item.nome}</h4>
                    <p class="asporto-card-desc">{formatDesc(item)}</p>
                    <span class="asporto-card-price">{formatPrice(item.prezzo)}</span>
                  </div>
                  <button class="asporto-card-close-btn" aria-label="Chiudi">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                      <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>
  )}

  {insalatone.length > 0 && <div class="section-divider"></div>}

  <!-- Contorni -->
  {contorni.length > 0 && (
    <section class="asporto-menu-section asporto-menu-section-alt" id="contorni">
      <div class="container">
        <h3 class="asporto-section-title">Contorni</h3>
        <div class="asporto-grid">
          {contorni.map((item) => (
            <div class="asporto-card" data-has-desc={formatDesc(item) ? "true" : "false"}>
              <div class="asporto-card-inner">
                <div class="asporto-card-front">
                  <div class="asporto-card-image"
                       data-detail-img={`${getImagePath(item.categoria, item.slug)}-dettaglio.webp`}
                       data-item-name={item.nome}>
                    <img 
                      src={`${getImagePath(item.categoria, item.slug)}.webp`}
                      alt={`${item.nome} ristorante pizzeria tre merate`}
                      loading="lazy"
                      decoding="async"
                      width="280"
                      height="350"
                    />
                    <div class="asporto-zoom-overlay">
                      <img 
                        src={`${getImagePath(item.categoria, item.slug)}-dettaglio.webp`}
                        alt={`${item.nome} dettaglio`}
                        loading="lazy"
                      />
                    </div>
                    <span class="asporto-zoom-hint">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"/>
                        <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <path d="M11 8v6M8 11h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    </span>
                  </div>
                  <div class="asporto-card-info">
                    <h4 class="asporto-card-name">{item.nome}</h4>
                    <span class="asporto-card-price">{formatPrice(item.prezzo)}</span>
                  </div>
                  {formatDesc(item) && (
                    <button class="asporto-card-info-btn" aria-label="Mostra descrizione">
                      <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                        <path d="M12 16v-4M12 8h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    </button>
                  )}
                </div>
                <div class="asporto-card-back">
                  <div class="asporto-card-back-content">
                    <h4 class="asporto-card-name">{item.nome}</h4>
                    <p class="asporto-card-desc">{formatDesc(item)}</p>
                    <span class="asporto-card-price">{formatPrice(item.prezzo)}</span>
                  </div>
                  <button class="asporto-card-close-btn" aria-label="Chiudi">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                      <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>
  )}

  {contorni.length > 0 && <div class="section-divider"></div>}

  <!-- Dessert -->
  {dessert.length > 0 && (
    <section class="asporto-menu-section" id="dessert">
      <div class="container">
        <h3 class="asporto-section-title">Dessert</h3>
        <div class="asporto-grid">
          {dessert.map((item) => (
            <div class="asporto-card" data-has-desc={formatDesc(item) ? "true" : "false"}>
              <div class="asporto-card-inner">
                <div class="asporto-card-front">
                  <div class="asporto-card-image"
                       data-detail-img={`${getImagePath(item.categoria, item.slug)}-dettaglio.webp`}
                       data-item-name={item.nome}>
                    <img 
                      src={`${getImagePath(item.categoria, item.slug)}.webp`}
                      alt={`${item.nome} ristorante pizzeria tre merate`}
                      loading="lazy"
                      decoding="async"
                      width="280"
                      height="350"
                    />
                    <div class="asporto-zoom-overlay">
                      <img 
                        src={`${getImagePath(item.categoria, item.slug)}-dettaglio.webp`}
                        alt={`${item.nome} dettaglio`}
                        loading="lazy"
                      />
                    </div>
                    <span class="asporto-zoom-hint">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"/>
                        <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <path d="M11 8v6M8 11h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    </span>
                  </div>
                  <div class="asporto-card-info">
                    <h4 class="asporto-card-name">{item.nome}</h4>
                    <span class="asporto-card-price">{formatPrice(item.prezzo)}</span>
                  </div>
                  {formatDesc(item) && (
                    <button class="asporto-card-info-btn" aria-label="Mostra descrizione">
                      <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                        <path d="M12 16v-4M12 8h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    </button>
                  )}
                </div>
                <div class="asporto-card-back">
                  <div class="asporto-card-back-content">
                    <h4 class="asporto-card-name">{item.nome}</h4>
                    <p class="asporto-card-desc">{formatDesc(item)}</p>
                    <span class="asporto-card-price">{formatPrice(item.prezzo)}</span>
                  </div>
                  <button class="asporto-card-close-btn" aria-label="Chiudi">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                      <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>
  )}

  {dessert.length > 0 && <div class="section-divider"></div>}

  <!-- Bevande -->
  {bevande.length > 0 && (
    <section class="asporto-menu-section asporto-menu-section-alt" id="bevande">
      <div class="container">
        <h3 class="asporto-section-title">Bevande</h3>
        <div class="asporto-grid">
          {bevande.map((item) => (
            <div class="asporto-card" data-has-desc={formatDesc(item) ? "true" : "false"}>
              <div class="asporto-card-inner">
                <div class="asporto-card-front">
                  <div class="asporto-card-image"
                       data-detail-img={`${getImagePath(item.categoria, item.slug)}-dettaglio.webp`}
                       data-item-name={item.nome}>
                    <img 
                      src={`${getImagePath(item.categoria, item.slug)}.webp`}
                      alt={`${item.nome} ristorante pizzeria tre merate`}
                      loading="lazy"
                      decoding="async"
                      width="280"
                      height="350"
                    />
                    <div class="asporto-zoom-overlay">
                      <img 
                        src={`${getImagePath(item.categoria, item.slug)}-dettaglio.webp`}
                        alt={`${item.nome} dettaglio`}
                        loading="lazy"
                      />
                    </div>
                    <span class="asporto-zoom-hint">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"/>
                        <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <path d="M11 8v6M8 11h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    </span>
                  </div>
                  <div class="asporto-card-info">
                    <h4 class="asporto-card-name">{item.nome}</h4>
                    <span class="asporto-card-price">{formatPrice(item.prezzo)}</span>
                  </div>
                  {formatDesc(item) && (
                    <button class="asporto-card-info-btn" aria-label="Mostra descrizione">
                      <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                        <path d="M12 16v-4M12 8h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    </button>
                  )}
                </div>
                <div class="asporto-card-back">
                  <div class="asporto-card-back-content">
                    <h4 class="asporto-card-name">{item.nome}</h4>
                    <p class="asporto-card-desc">{formatDesc(item)}</p>
                    <span class="asporto-card-price">{formatPrice(item.prezzo)}</span>
                  </div>
                  <button class="asporto-card-close-btn" aria-label="Chiudi">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                      <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>
  )}

  {bevande.length > 0 && <div class="section-divider"></div>}

  <!-- Birre -->
  {birre.length > 0 && (
    <section class="asporto-menu-section" id="birre">
      <div class="container">
        <h3 class="asporto-section-title">Birre</h3>
        <div class="asporto-grid">
          {birre.map((item) => (
            <div class="asporto-card" data-has-desc={formatDesc(item) ? "true" : "false"}>
              <div class="asporto-card-inner">
                <div class="asporto-card-front">
                  <div class="asporto-card-image"
                       data-detail-img={`${getImagePath(item.categoria, item.slug)}-dettaglio.webp`}
                       data-item-name={item.nome}>
                    <img 
                      src={`${getImagePath(item.categoria, item.slug)}.webp`}
                      alt={`${item.nome} ristorante pizzeria tre merate`}
                      loading="lazy"
                      decoding="async"
                      width="280"
                      height="350"
                    />
                    <div class="asporto-zoom-overlay">
                      <img 
                        src={`${getImagePath(item.categoria, item.slug)}-dettaglio.webp`}
                        alt={`${item.nome} dettaglio`}
                        loading="lazy"
                      />
                    </div>
                    <span class="asporto-zoom-hint">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"/>
                        <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <path d="M11 8v6M8 11h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    </span>
                  </div>
                  <div class="asporto-card-info">
                    <h4 class="asporto-card-name">{item.nome}</h4>
                    <span class="asporto-card-price">{formatPrice(item.prezzo)}</span>
                  </div>
                  {formatDesc(item) && (
                    <button class="asporto-card-info-btn" aria-label="Mostra descrizione">
                      <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                        <path d="M12 16v-4M12 8h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    </button>
                  )}
                </div>
                <div class="asporto-card-back">
                  <div class="asporto-card-back-content">
                    <h4 class="asporto-card-name">{item.nome}</h4>
                    <p class="asporto-card-desc">{formatDesc(item)}</p>
                    <span class="asporto-card-price">{formatPrice(item.prezzo)}</span>
                  </div>
                  <button class="asporto-card-close-btn" aria-label="Chiudi">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                      <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>
  )}

  {birre.length > 0 && <div class="section-divider"></div>}

  <!-- Vini -->
  {vini.length > 0 && (
    <section class="asporto-menu-section asporto-menu-section-alt" id="vini">
      <div class="container">
        <h3 class="asporto-section-title">Vini</h3>
        <div class="asporto-grid">
          {vini.map((item) => (
            <div class="asporto-card" data-has-desc={formatDesc(item) ? "true" : "false"}>
              <div class="asporto-card-inner">
                <div class="asporto-card-front">
                  <div class="asporto-card-image"
                       data-detail-img={`${getImagePath(item.categoria, item.slug)}-dettaglio.webp`}
                       data-item-name={item.nome}>
                    <img 
                      src={`${getImagePath(item.categoria, item.slug)}.webp`}
                      alt={`${item.nome} ristorante pizzeria tre merate`}
                      loading="lazy"
                      decoding="async"
                      width="280"
                      height="350"
                    />
                    <div class="asporto-zoom-overlay">
                      <img 
                        src={`${getImagePath(item.categoria, item.slug)}-dettaglio.webp`}
                        alt={`${item.nome} dettaglio`}
                        loading="lazy"
                      />
                    </div>
                    <span class="asporto-zoom-hint">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"/>
                        <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <path d="M11 8v6M8 11h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    </span>
                  </div>
                  <div class="asporto-card-info">
                    <h4 class="asporto-card-name">{item.nome}</h4>
                    <span class="asporto-card-price">{formatPrice(item.prezzo)}</span>
                  </div>
                  {formatDesc(item) && (
                    <button class="asporto-card-info-btn" aria-label="Mostra descrizione">
                      <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                        <path d="M12 16v-4M12 8h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                      </svg>
                    </button>
                  )}
                </div>
                <div class="asporto-card-back">
                  <div class="asporto-card-back-content">
                    <h4 class="asporto-card-name">{item.nome}</h4>
                    <p class="asporto-card-desc">{formatDesc(item)}</p>
                    <span class="asporto-card-price">{formatPrice(item.prezzo)}</span>
                  </div>
                  <button class="asporto-card-close-btn" aria-label="Chiudi">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                      <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>
  )}

  <!-- Allergeni -->
  <section class="allergens-section">
    <div class="container">
      <div class="allergens-box">
        <h3>Allergeni</h3>
        <p>
          (1) glutine, (2) crostacei, (3) uova, (4) pesce, (5) arachidi, (6) soia, (7) latte, (8) frutta a guscio,
          (9) sedano, (10) senape, (11) semi di sesamo, (12) anidride solforosa, (13) lupini, (14) molluschi
        </p>
        <p class="allergens-note">
          Per intolleranze e allergie chiedere al personale di sala.<br />
          *alcuni prodotti potrebbero essere congelati.
        </p>
      </div>
    </div>
  </section>

  <div class="section-divider"></div>

  <!-- CTA Section -->
  <section class="cta-section cta-section-menu-asporto">
    <div class="container">
      <h2>Pronto per Ordinare?</h2>
      <p>
        Ordina online, seleziona l'orario di ritiro e passa a ritirare il tuo ordine già pronto. Paghi comodamente al ritiro!
      </p>
      <div class="cta-buttons">
        <span 
          class="btn btn-primary btn-gloriafood"
          data-glf-cuid={gloriaFoodCuid}
          data-glf-ruid={gloriaFoodRuid}
        >
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M9 22C9.55228 22 10 21.5523 10 21C10 20.4477 9.55228 20 9 20C8.44772 20 8 20.4477 8 21C8 21.5523 8.44772 22 9 22Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M20 22C20.5523 22 21 21.5523 21 21C21 20.4477 20.5523 20 20 20C19.4477 20 19 20.4477 19 21C19 21.5523 19.4477 22 20 22Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M1 1H5L7.68 14.39C7.77144 14.8504 8.02191 15.264 8.38755 15.5583C8.75318 15.8526 9.2107 16.009 9.68 16H19.4C19.8693 16.009 20.3268 15.8526 20.6925 15.5583C21.0581 15.264 21.3086 14.8504 21.4 14.39L23 6H6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Ordina Online
        </span>
        <a href="https://wa.me/393517701704" target="_blank" class="btn btn-whatsapp">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L0 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
          </svg>
          WhatsApp
        </a>
      </div>
    </div>
  </section>

  <div class="section-divider"></div>

  <!-- Sticky CTA Bottom -->
  <div class="sticky-cta-bottom" id="sticky-cta">
    <div class="sticky-cta-container">
      <div class="sticky-cta-logo">
        <img src="/img/brand/tre-logo.svg" alt="logo pizzeria TRE merate" width="50" height="50" />
      </div>
      <div class="sticky-cta-content">
        <span class="sticky-cta-title">Ristorante Pizzeria TRE</span>
        <span class="sticky-cta-subtitle">Ordina d'Asporto</span>
      </div>
      <span class="btn btn-primary sticky-cta-btn btn-gloriafood"
        data-glf-cuid={gloriaFoodCuid}
        data-glf-ruid={gloriaFoodRuid}
      >Ordina Online</span>
    </div>
  </div>

  <!-- Image Lightbox -->
  <div class="lightbox" id="lightbox">
    <button class="lightbox-close" aria-label="Chiudi">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
        <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
      </svg>
    </button>
    <div class="lightbox-content">
      <img src="" alt="" class="lightbox-img" />
      <p class="lightbox-caption"></p>
    </div>
  </div>

  <!-- GloriaFood Script -->
  <script is:inline src="https://www.fbgcdn.com/embedder/js/ewm2.js" defer async></script>
</Layout>

<style>
  /* Hero Menu Asporto */
  .hero-menu-asporto {
    background-image:
      linear-gradient(rgba(0, 0, 0, 0.62), rgba(0, 0, 0, 0.62)),
      url('/img/menu-asporto/menu-asporto-ristorante-pizzeria-tre-merate-hero.webp');
  }

  /* CTA Menu Asporto */
  .cta-section-menu-asporto {
    background-image:
      linear-gradient(rgba(0, 0, 0, 0.65), rgba(0, 0, 0, 0.65)),
      url('/img/menu-asporto/menu-asporto-ristorante-pizzeria-tre-merate-hero.webp');
  }

  .cta-buttons {
    display: flex;
    gap: 1rem;
    justify-content: center;
    flex-wrap: wrap;
  }

  .cta-buttons .btn {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
  }

  /* ===== SUBMENU STYLING ===== */
  /* ===== SUBMENU ASPORTO - VERSIONE ESTESA (14 voci) ===== */
  .submenu-sticky {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }

  .submenu-sticky .container {
    max-width: none;
    padding: 0;
  }

  .submenu-list {
    display: flex;
    justify-content: flex-start;
    gap: 0.4rem;
    padding: 0 1rem;
    overflow-x: auto;
    scrollbar-width: none;
    -ms-overflow-style: none;
  }

  .submenu-list::-webkit-scrollbar {
    display: none;
  }

  .submenu-link {
    font-size: 15px;
    padding: 0.4rem 0.7rem;
    flex-shrink: 0;
    white-space: nowrap;
  }

  @media (min-width: 768px) {
    .submenu-list {
      padding: 0 2rem;
      gap: 0.6rem;
    }

    .submenu-link {
      font-size: 16px;
      padding: 0.45rem 0.85rem;
    }
  }

  @media (min-width: 1400px) {
    .submenu-list {
      justify-content: center;
    }
  }

  /* ===== COME FUNZIONA SECTION ===== */
  .come-funziona-section {
    padding: 4rem 0;
    background-color: var(--bg-light);
    position: relative;
  }

  @media (min-width: 768px) {
    .come-funziona-section {
      padding: 5rem 0;
    }
  }

  .come-funziona-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 3rem;
    align-items: center;
    margin-bottom: 3rem;
  }

  @media (min-width: 992px) {
    .come-funziona-grid {
      grid-template-columns: 1fr 1fr;
      gap: 4rem;
    }
  }

  .come-funziona-content h2 {
    font-size: 40px;
    line-height: 48px;
    margin-bottom: 1rem;
    color: var(--text-dark);
  }

  .come-funziona-intro {
    font-size: 20px;
    line-height: 30px;
    color: var(--text-dark);
    opacity: 0.85;
    margin-bottom: 2rem;
  }

  .come-funziona-steps {
    list-style: none;
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .come-funziona-steps li {
    font-size: 18px;
    line-height: 26px;
    color: var(--text-dark);
    padding-left: 1.5rem;
    position: relative;
  }

  .come-funziona-steps li::before {
    content: "•";
    position: absolute;
    left: 0;
    color: var(--primary-color);
    font-weight: 700;
  }

  .come-funziona-steps strong {
    color: var(--primary-color);
  }

  .come-funziona-image {
    border-radius: 12px;
    overflow: hidden;
  }

  .come-funziona-image img {
    width: 100%;
    height: auto;
    display: block;
  }

  @media (max-width: 768px) {
    .come-funziona-content h2 {
      font-size: 32px;
      line-height: 40px;
    }

    .come-funziona-intro {
      font-size: 18px;
      line-height: 28px;
    }
  }

  /* Coming Soon Overlay */
  .coming-soon-overlay {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 10;
    width: 100%;
    max-width: 500px;
    padding: 0 1rem;
  }

  .coming-soon-box {
    background-color: var(--bg-white);
    border-radius: 16px;
    padding: 2.5rem 2rem;
    text-align: center;
    box-shadow: 0 8px 40px rgba(0, 0, 0, 0.15);
    border: 2px solid var(--primary-color);
  }

  .coming-soon-icon {
    width: 80px;
    height: 80px;
    background-color: var(--primary-pale);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 1.5rem;
    color: var(--primary-color);
  }

  .coming-soon-box h3 {
    font-size: 28px;
    line-height: 34px;
    color: var(--text-dark);
    margin-bottom: 1rem;
  }

  .coming-soon-box p {
    font-size: 16px;
    line-height: 24px;
    color: var(--text-dark);
    opacity: 0.8;
    margin-bottom: 2rem;
  }

  .coming-soon-buttons {
    display: flex;
    gap: 1rem;
    justify-content: center;
    flex-wrap: wrap;
  }

  .coming-soon-buttons .btn {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 16px;
    padding: 12px 24px;
  }

  .btn-whatsapp {
    background-color: #25D366;
    border-color: #25D366;
    color: var(--text-white);
  }

  .btn-whatsapp:hover,
  .btn-whatsapp:active,
  .btn-whatsapp:focus-visible {
    background-color: #128C7E;
    border-color: #128C7E;
    color: var(--text-white);
  }

  /* GloriaFood Button */
  .btn-gloriafood {
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
  }

  /* Come Funziona CTA */
  .come-funziona-cta {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
    margin-top: 2rem;
  }

  @media (max-width: 480px) {
    .come-funziona-cta {
      flex-direction: column;
    }
    
    .come-funziona-cta .btn {
      width: 100%;
      justify-content: center;
    }
  }

  @media (max-width: 768px) {
    .coming-soon-box {
      padding: 2rem 1.5rem;
    }

    .coming-soon-box h3 {
      font-size: 24px;
      line-height: 30px;
    }

    .coming-soon-box p {
      font-size: 14px;
      line-height: 22px;
    }

    .coming-soon-buttons {
      flex-direction: column;
    }
  }

  /* Steps Visual */
  .come-funziona-visual {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 1rem;
    flex-wrap: wrap;
  }

  .step-visual {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
  }

  .step-number {
    width: 50px;
    height: 50px;
    background-color: var(--primary-color);
    color: var(--text-white);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    font-weight: 700;
  }

  .step-label {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-dark);
    text-align: center;
  }

  .step-connector {
    width: 40px;
    height: 2px;
    background-color: var(--primary-light);
  }

  @media (max-width: 600px) {
    .come-funziona-visual {
      gap: 0.5rem;
    }

    .step-number {
      width: 40px;
      height: 40px;
      font-size: 18px;
    }

    .step-label {
      font-size: 12px;
    }

    .step-connector {
      width: 20px;
    }
  }

  /* ===== SELEZIONA PIATTI SECTION ===== */
  .seleziona-piatti-section {
    padding: 4rem 0 2rem;
    background-color: var(--bg-white);
    scroll-margin-top: 200px;
  }

  @media (min-width: 992px) {
    .seleziona-piatti-section {
      scroll-margin-top: 220px;
    }
  }

  /* ===== ASPORTO MENU SECTION ===== */
  .asporto-menu-section {
    padding: 3rem 0;
    background-color: var(--bg-white);
    scroll-margin-top: 200px;
  }

  .asporto-menu-section-alt {
    background-color: var(--bg-light);
  }

  @media (min-width: 768px) {
    .asporto-menu-section {
      padding: 4rem 0;
    }
  }

  @media (min-width: 992px) {
    .asporto-menu-section {
      scroll-margin-top: 220px;
    }
  }

  .asporto-section-title {
    font-size: 32px;
    line-height: 40px;
    color: var(--primary-color);
    margin-bottom: 2rem;
    text-align: center;
  }

  @media (max-width: 768px) {
    .asporto-section-title {
      font-size: 28px;
      line-height: 35px;
    }
  }

  /* Asporto Grid */
  .asporto-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1.5rem;
  }

  @media (min-width: 768px) {
    .asporto-grid {
      grid-template-columns: repeat(3, 1fr);
      gap: 2rem;
    }
  }

  @media (min-width: 1200px) {
    .asporto-grid {
      grid-template-columns: repeat(4, 1fr);
    }
  }

  /* ===== ASPORTO CARD - FLIP EFFECT ===== */
  .asporto-card {
    perspective: 1000px;
    height: 340px;
  }

  @media (max-width: 768px) {
    .asporto-card {
      height: 300px;
    }
  }

  .asporto-card-inner {
    position: relative;
    width: 100%;
    height: 100%;
    transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    transform-style: preserve-3d;
  }

  .asporto-card.flipped .asporto-card-inner {
    transform: rotateY(180deg);
  }

  .asporto-card-front,
  .asporto-card-back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
  }

  /* Front of card */
  .asporto-card-front {
    background-color: var(--bg-white);
    display: flex;
    flex-direction: column;
  }

  .asporto-card-image {
    height: 240px;
    overflow: hidden;
    position: relative;
    cursor: pointer;
  }

  @media (max-width: 768px) {
    .asporto-card-image {
      height: 210px;
    }
  }

  .asporto-card-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center 70%;
    transition: transform 0.5s ease, opacity 0.3s ease;
  }

  .asporto-card:hover .asporto-card-image img {
    transform: scale(1.05);
  }

  /* ===== ZOOM OVERLAY (DESKTOP) ===== */
  .asporto-zoom-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.92);
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10;
    cursor: zoom-in;
    overflow: hidden;
  }

  .asporto-zoom-overlay img {
    width: 180%;
    height: 180%;
    object-fit: cover;
    object-position: center 65%;
    border-radius: 0;
    box-shadow: none;
    transform: scale(1);
    transition: transform 0.3s ease;
  }

  /* Desktop: hover mostra zoom */
  @media (min-width: 769px) {
    .asporto-card-image:hover .asporto-zoom-overlay {
      opacity: 1;
      visibility: visible;
    }
    
    .asporto-card-image:hover .asporto-zoom-overlay img {
      transform: scale(1.05);
    }
  }

  /* Icona zoom sull'immagine */
  .asporto-zoom-hint {
    position: absolute;
    bottom: 8px;
    left: 8px;
    width: 28px;
    height: 28px;
    background-color: rgba(255, 255, 255, 0.9);
    color: var(--text-dark);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity 0.3s ease;
    pointer-events: none;
    z-index: 5;
  }

  .asporto-card-image:hover .asporto-zoom-hint {
    opacity: 1;
  }

  @media (max-width: 768px) {
    .asporto-zoom-hint {
      opacity: 0.7;
    }
  }

  /* ===== INFO COMPATTA ===== */
  .asporto-card-info {
    flex: 1;
    padding: 0.75rem 1rem;
    padding-right: 3rem;
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
    gap: 0.5rem;
    min-height: 60px;
    position: relative;
  }

  .asporto-card-name {
    font-size: 15px;
    font-weight: 600;
    line-height: 1.25;
    color: var(--text-dark);
    margin: 0;
    flex: 1;
    text-align: left;
  }

  @media (max-width: 768px) {
    .asporto-card-name {
      font-size: 14px;
    }
    
    .asporto-card-info {
      padding-right: 2.75rem;
    }
  }

  .asporto-card-price {
    font-size: 17px;
    font-weight: 700;
    color: var(--primary-color);
    white-space: nowrap;
    flex-shrink: 0;
  }

  @media (max-width: 768px) {
    .asporto-card-price {
      font-size: 15px;
    }
  }

  /* Info button */
  .asporto-card-info-btn {
    position: absolute;
    bottom: 10px;
    right: 10px;
    width: 32px;
    height: 32px;
    background-color: var(--primary-color);
    color: var(--text-white);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    z-index: 15;
  }

  @media (max-width: 768px) {
    .asporto-card-info-btn {
      width: 28px;
      height: 28px;
      bottom: 8px;
      right: 8px;
    }
    
    .asporto-card-info-btn svg {
      width: 16px;
      height: 16px;
    }
  }

  .asporto-card-info-btn:hover {
    background-color: var(--primary-hover);
    transform: scale(1.1);
  }

  /* Back of card */
  .asporto-card-back {
    background-color: var(--primary-color);
    color: var(--text-white);
    transform: rotateY(180deg);
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding: 1.5rem;
  }

  .asporto-card-back-content {
    text-align: center;
  }

  .asporto-card-back .asporto-card-name {
    color: var(--text-white);
    font-size: 18px;
    margin-bottom: 0.75rem;
    text-align: center;
  }

  .asporto-card-desc {
    font-size: 14px;
    line-height: 1.5;
    color: var(--text-white);
    opacity: 0.9;
    margin: 0 0 1rem;
  }

  @media (max-width: 768px) {
    .asporto-card-desc {
      font-size: 13px;
    }
  }

  .asporto-card-back .asporto-card-price {
    color: var(--text-white);
    font-size: 20px;
  }

  /* Close button */
  .asporto-card-close-btn {
    position: absolute;
    top: 12px;
    right: 12px;
    width: 32px;
    height: 32px;
    background-color: rgba(255, 255, 255, 0.2);
    color: var(--text-white);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
  }

  .asporto-card-close-btn:hover {
    background-color: rgba(255, 255, 255, 0.3);
  }

  /* ===== ALLERGENS SECTION ===== */
  .allergens-section {
    padding: 3rem 0;
    background-color: var(--bg-white);
  }

  .allergens-box {
    background-color: var(--bg-light);
    border-radius: 12px;
    padding: 2rem;
    text-align: center;
  }

  .allergens-box h3 {
    font-size: 24px;
    color: var(--text-dark);
    margin-bottom: 1rem;
  }

  .allergens-list {
    font-size: 14px;
    line-height: 1.8;
    color: var(--text-dark);
    opacity: 0.85;
    margin-bottom: 1rem;
  }

  .allergens-note {
    font-size: 13px;
    font-style: italic;
    color: var(--text-dark);
    opacity: 0.7;
  }

  /* ===== LIGHTBOX ===== */
  .lightbox {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.95);
    z-index: 9999;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
  }

  .lightbox.active {
    opacity: 1;
    visibility: visible;
  }

  .lightbox-close {
    position: absolute;
    top: 20px;
    right: 20px;
    width: 48px;
    height: 48px;
    background-color: rgba(255, 255, 255, 0.1);
    color: var(--text-white);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    z-index: 10;
  }

  .lightbox-close:hover {
    background-color: rgba(255, 255, 255, 0.2);
  }

  .lightbox-content {
    max-width: 90vw;
    max-height: 90vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1rem;
  }

  .lightbox-img {
    max-width: 100%;
    max-height: 80vh;
    object-fit: contain;
    border-radius: 8px;
  }

  .lightbox-caption {
    font-size: 18px;
    color: var(--text-white);
    text-align: center;
  }

  .capacity-alert-section {
    padding: 1rem 0 0;
  }
  
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    initCardFlip();
    initLightbox();
    initSubmenu();
    initStickyCta();
  });

  function initCardFlip() {
    const infoButtons = document.querySelectorAll('.asporto-card-info-btn');
    const closeButtons = document.querySelectorAll('.asporto-card-close-btn');

    infoButtons.forEach(btn => {
      btn.addEventListener('click', (e) => {
        e.stopPropagation();
        const card = btn.closest('.asporto-card');
        if (card) {
          card.classList.add('flipped');
        }
      });
    });

    closeButtons.forEach(btn => {
      btn.addEventListener('click', (e) => {
        e.stopPropagation();
        const card = btn.closest('.asporto-card');
        if (card) {
          card.classList.remove('flipped');
        }
      });
    });
  }

  function initLightbox() {
    const lightbox = document.getElementById('lightbox');
    const lightboxImg = lightbox?.querySelector('.lightbox-img') as HTMLImageElement;
    const lightboxCaption = lightbox?.querySelector('.lightbox-caption');
    const lightboxClose = lightbox?.querySelector('.lightbox-close');
    const cardImages = document.querySelectorAll('.asporto-card-image');

    if (!lightbox) return;

    cardImages.forEach(cardImage => {
      cardImage.addEventListener('click', (e) => {
        const isMobile = window.innerWidth <= 768;
        
        if (isMobile) {
          const detailImg = (cardImage as HTMLElement).dataset.detailImg;
          const itemName = (cardImage as HTMLElement).dataset.itemName;
          
          if (detailImg && lightboxImg) {
            lightboxImg.src = detailImg;
            lightboxImg.alt = itemName + ' dettaglio';
            if (lightboxCaption) lightboxCaption.textContent = itemName || '';
            lightbox.classList.add('active');
            document.body.style.overflow = 'hidden';
          }
        }
      });
    });
    
    const closeLightbox = () => {
      lightbox.classList.remove('active');
      document.body.style.overflow = '';
      if (lightboxImg) lightboxImg.src = '';
    };
    
    if (lightboxClose) {
      lightboxClose.addEventListener('click', closeLightbox);
    }
    
    lightbox.addEventListener('click', (e) => {
      if (e.target === lightbox) {
        closeLightbox();
      }
    });
    
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && lightbox.classList.contains('active')) {
        closeLightbox();
      }
    });
  }

  function initSubmenu() {
    const header = document.getElementById('main-header');
    const submenu = document.getElementById('submenu-sticky');
    const submenuList = document.querySelector('.submenu-list');
    const submenuLinks = document.querySelectorAll('.submenu-link');
    const sections = document.querySelectorAll('.asporto-menu-section[id], .seleziona-piatti-section[id]');

    const getOffset = () => {
      const headerHeight = header ? header.offsetHeight : 0;
      const submenuHeight = submenu ? submenu.offsetHeight : 0;
      return headerHeight + submenuHeight + 40;
    };

    const scrollSubmenuToActiveLink = (activeLink: Element) => {
      if (!submenuList || !activeLink) return;
      //if (window.innerWidth > 768) return;

      const scrollLeft = (activeLink as HTMLElement).offsetLeft - 16;
      submenuList.scrollTo({
        left: scrollLeft,
        behavior: 'smooth'
      });
    };

    const highlightActiveLink = () => {
      const scrollPos = window.scrollY + getOffset() + 50;

      sections.forEach((section) => {
        const sectionTop = (section as HTMLElement).offsetTop;
        const sectionHeight = (section as HTMLElement).offsetHeight;
        const sectionId = section.getAttribute('id');

        if (scrollPos >= sectionTop && scrollPos < sectionTop + sectionHeight) {
          submenuLinks.forEach((link) => {
            const wasActive = link.classList.contains('active');
            link.classList.remove('active');
            
            if (link.getAttribute('href') === `#${sectionId}`) {
              link.classList.add('active');
              if (!wasActive) {
                scrollSubmenuToActiveLink(link);
              }
            }
          });
        }
      });
    };

    window.addEventListener('scroll', highlightActiveLink);

    submenuLinks.forEach((link) => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const targetId = link.getAttribute('href');
        const targetSection = targetId ? document.querySelector(targetId) : null;
        if (targetSection) {
          const targetPosition = (targetSection as HTMLElement).offsetTop - getOffset();
          window.scrollTo({
            top: targetPosition,
            behavior: 'smooth'
          });
          scrollSubmenuToActiveLink(link);
        }
      });
    });

    document.querySelectorAll('a[href^="#"]').forEach((link) => {
      if (!link.classList.contains('submenu-link')) {
        link.addEventListener('click', (e) => {
          const targetId = link.getAttribute('href');
          if (targetId === '#' || targetId === '#!') return;
          
          e.preventDefault();
          const targetSection = targetId ? document.querySelector(targetId) : null;
          if (targetSection) {
            const targetPosition = (targetSection as HTMLElement).offsetTop - getOffset() + 20;
            window.scrollTo({
              top: targetPosition,
              behavior: 'smooth'
            });
          }
        });
      }
    });
  }

  function initStickyCta() {
    const stickyCta = document.getElementById('sticky-cta');
    const heroSection = document.querySelector('.hero');
    const ctaSection = document.querySelector('.cta-section');

    if (!stickyCta || !heroSection || !ctaSection) return;

    const handleScroll = () => {
      const heroBottom = heroSection.getBoundingClientRect().bottom;
      const ctaTop = ctaSection.getBoundingClientRect().top;
      const windowHeight = window.innerHeight;

      const shouldShow = heroBottom < 0 && ctaTop > windowHeight - 100;

      if (shouldShow) {
        stickyCta.classList.add('visible');
      } else {
        stickyCta.classList.remove('visible');
      }
    };

    window.addEventListener('scroll', handleScroll);
    handleScroll();
  }
</script>